SELECT PDKCOO, PDDOCO, PDDCTO, PDSFXO, PDLNID, PDMCU, PDCO, PDOKCO, PDOORN, PDOCTO, PDOGNO, PDRKCO, PDRORN, PDRCTO, PDRLLN, PDDMCT, PDDMCS, PDBALU, PDAN8, PDSHAN, PDDRQJ, PDTRDJ, PDPDDJ, PDOPDJ, PDADDJ, PDCNDJ, PDPEFJ, PDPPDJ, PDPSDJ, PDDSVJ, PDDGL, PDPN, PDVR01, PDVR02, PDITM, PDLITM, PDAITM, PDLOCN, PDLOTN, PDFRGD, PDTHGD, PDFRMP, PDTHRP, PDDSC1, PDDSC2, PDLNTY, PDNXTR, PDLTTR, PDRLIT, PDPDS1, PDPDS2, PDPDS3, PDPDS4, PDPDS5, PDPDP1, PDPDP2, PDPDP3, PDPDP4, PDPDP5, PDUOM, PDUORG, PDUCHG, PDUOPN, PDUREC, PDCREC, PDURLV, PDOTQY, PDPRRC, PDAEXP, PDACHG, PDAOPN, PDAREC, PDARLV, PDFTN1, PDTRLV, PDPROV, PDAMC3, PDECST, PDCSTO, PDCSMP, PDINMG, PDASN, PDPRGR, PDCLVL, PDCATN, PDDSPR, PDPTC, PDTX, PDEXR1, PDTXA1, PDATXT, PDCNID, PDCDCD, PDNTR, PDFRTH, PDFRTC, PDZON, PDFRAT, PDRATT, PDANBY, PDANCR, PDMOT, PDCOT, PDSHCM, PDSHCN, PDUOM1, PDPQOR, PDUOM2, PDSQOR, PDUOM3, PDITWT, PDWTUM, PDITVL, PDVLUM, PDGLC, PDCTRY, PDFY, PDSTTS, PDRCD, PDFUF1, PDFUF2, PDGRWT, PDGWUM, PDLT, PDANI, PDAID, PDOMCU, PDOBJ, PDSUB, PDSBLT, PDSBL, PDASID, PDCCMP, PDTAG, PDWR01, PDPL, PDELEV, PDR001, PDRTNR, PDLCOD, PDPURG, PDPROM, PDFNLP, PDAVCH, PDPRPY, PDUNCD, PDMATY, PDRTGC, PDRCPF, PDPS01, PDPS02, PDPS03, PDPS04, PDPS05, PDPS06, PDPS07, PDPS08, PDPS09, PDPS10, PDCRMD, PDARTG, PDCORD, PDCHDT, PDDOCC, PDCHLN, PDCRCD, PDCRR, PDFRRC, PDFEA, PDFUC, PDFEC, PDFCHG, PDFAP, PDFREC, PDURCD, PDURDT, PDURAT, PDURAB, PDURRF, PDTORG, PDUSER, PDPID, PDJOBN, PDUPMJ, PDTDAY, PDVR05, PDVR04, PDSHPN, PDRSHT, PDPRJM, PDOSFX, PDMERL, PDMCLN, PDMACT, PDKTLN, PDFTRL, PDDUAL, PDDRQT, PDDLEJ, PDCTAM, PDCPNT, PDCHT, PDCHRT, PDCHRS, PDCHMJ, PDBCRC, PDVR03, PDLDNM, PDMKFR, PDPMTN, PDUKID, PDUNSPSC, PDCMDCDE, PDRSFX, PDWVID, PDCNTRTID, PDCNTRTDID, PDMOADJ, PDPODC01, PDPODC02, PDPODC03, PDPODC04, PDJBCD, PDSRQTY, PDSRUOM, PDCFGFL, CDC_SRC_LAST_UPDATE_DATE, CDC_RPL_LAST_UPDATE_DATE
FROM E1_PRODUCTION.E1.F4311;

SELECT PDKCOO, PDDOCO, PDDCTO, PDSFXO, PDLNID, PDMCU, PDCO, PDOKCO, PDOORN, PDOCTO, PDOGNO, PDRKCO, PDRORN, PDRCTO, PDRLLN, PDDMCT, PDDMCS, PDBALU, PDAN8, PDSHAN, PDDRQJ, PDTRDJ, PDPDDJ, PDOPDJ, PDADDJ, PDCNDJ, PDPEFJ, PDPPDJ, PDPSDJ, PDDSVJ, PDDGL, PDPN, PDVR01, PDVR02, PDITM, PDLITM, PDAITM, PDLOCN, PDLOTN, PDFRGD, PDTHGD, PDFRMP, PDTHRP, PDDSC1, PDDSC2, PDLNTY, PDNXTR, PDLTTR, PDRLIT, PDPDS1, PDPDS2, PDPDS3, PDPDS4, PDPDS5, PDPDP1, PDPDP2, PDPDP3, PDPDP4, PDPDP5, PDUOM, PDUORG, PDUCHG, PDUOPN, PDUREC, PDCREC, PDURLV, PDOTQY, PDPRRC, PDAEXP, PDACHG, PDAOPN, PDAREC, PDARLV, PDFTN1, PDTRLV, PDPROV, PDAMC3, PDECST, PDCSTO, PDCSMP, PDINMG, PDASN, PDPRGR, PDCLVL, PDCATN, PDDSPR, PDPTC, PDTX, PDEXR1, PDTXA1, PDATXT, PDCNID, PDCDCD, PDNTR, PDFRTH, PDFRTC, PDZON, PDFRAT, PDRATT, PDANBY, PDANCR, PDMOT, PDCOT, PDSHCM, PDSHCN, PDUOM1, PDPQOR, PDUOM2, PDSQOR, PDUOM3, PDITWT, PDWTUM, PDITVL, PDVLUM, PDGLC, PDCTRY, PDFY, PDSTTS, PDRCD, PDFUF1, PDFUF2, PDGRWT, PDGWUM, PDLT, PDANI, PDAID, PDOMCU, PDOBJ, PDSUB, PDSBLT, PDSBL, PDASID, PDCCMP, PDTAG, PDWR01, PDPL, PDELEV, PDR001, PDRTNR, PDLCOD, PDPURG, PDPROM, PDFNLP, PDAVCH, PDPRPY, PDUNCD, PDMATY, PDRTGC, PDRCPF, PDPS01, PDPS02, PDPS03, PDPS04, PDPS05, PDPS06, PDPS07, PDPS08, PDPS09, PDPS10, PDCRMD, PDARTG, PDCORD, PDCHDT, PDDOCC, PDCHLN, PDCRCD, PDCRR, PDFRRC, PDFEA, PDFUC, PDFEC, PDFCHG, PDFAP, PDFREC, PDURCD, PDURDT, PDURAT, PDURAB, PDURRF, PDTORG, PDUSER, PDPID, PDJOBN, PDUPMJ, PDTDAY, PDVR05, PDVR04, PDSHPN, PDRSHT, PDPRJM, PDOSFX, PDMERL, PDMCLN, PDMACT, PDKTLN, PDFTRL, PDDUAL, PDDRQT, PDDLEJ, PDCTAM, PDCPNT, PDCHT, PDCHRT, PDCHRS, PDCHMJ, PDBCRC, PDVR03, PDLDNM, PDMKFR, PDPMTN, PDUKID, PDUNSPSC, PDCMDCDE, PDRSFX, PDWVID, PDCNTRTID, PDCNTRTDID, PDMOADJ, PDPODC01, PDPODC02, PDPODC03, PDPODC04, PDJBCD, PDSRQTY, PDSRUOM, PDCFGFL, CDC_SRC_LAST_UPDATE_DATE, CDC_RPL_LAST_UPDATE_DATE
FROM E1_PRODUCTION.E1.F4311 
WHERE pddoco=2926127 OR pddoco=2893364 ORDER BY pddoco;

USE DATABASE e1_PRODUCTION;

---Received trace tracking F550247A
SELECT count(*) FROM e1.f550247A;
SELECT * FROM e1.f550247A LIMIT 10;
SELECT ctmcu,ct55tset, count(*),min(ctupmj), max(ctupmj) FROM e1.f550247A GROUP BY ctmcu,ct55tset ORDER BY 1,2;
-- only old
SELECT ctmcu,ct55tset, count(*),min(ctupmj), max(ctupmj) FROM e1.f550247A 
WHERE ctmcu IN ('AGP','DC1', 'DLA','HD1','HD4','HD5','JUV','NC1','SC1') 
GROUP BY ctmcu,ct55tset ORDER BY 1,2;

SELECT TRIM(SZMCU) BU, 'F47072'   FILE, SZEDBT Batch, SZDOCO PO, SZDCTO Ty,szupmj, count(*) Records FROM e1.F47072   WHERE SZEDSP='N' AND SZUPMJ>'2022-11-06' 
AND SZMCU IN ('BDC', 'FL1', 'HD6', 'HD7', 'NDC', 'NC1', 'ON3', 'SC2', 'SC3') GROUP BY  SZMCU, SZEDBT , SZDOCO, SZDCTO,szupmj 
UNION 
SELECT TRIM(SZMCU) BU, 'F43092Z1' FILE, SZEDBT Batch, SZDOCO PO, SZDCTO Ty,szupmj, count(*) Records FROM e1.F43092Z1 WHERE SZEDSP='N' AND SZUPMJ>'2022-11-06' 
AND SZMCU IN ('BDC', 'FL1', 'HD6', 'HD7', 'NDC', 'NC1', 'ON3', 'SC2', 'SC3') GROUP BY  SZMCU, SZEDBT , SZDOCO, SZDCTO,szupmj 
ORDER BY 1,2,3,4;

SELECT szupmj, a.* FROM e1.F43092Z1 a WHERE szedsp='N' LIMIT 10;
SELECT * FROM e1.f4141 a WHERE pjmcu='PFD' LIMIT 10;
SELECT count(*) FROM e1.f4141 a LIMIT 10;

SELECT SRC_DC, DHERSQ, DHPRDT, DHPRTM, DHBCTN, DHDCR, DHTCR, DHPGM, DHUSER, DHWHSE, DHWKON, DHDCON, DHDCLN, DHOTYP, DHPCTP, DHWOAC, DHOSRC, DHCLOC, DHTRUK, DHMFLN, DHESTM, DHESDT, DHRQDT, DHSCDT, DHSCTM, DHSHMT, DHLOCN, DHPON, DHWKTP, DHWKGR, DHPATH, DHCMNT, DHPR, DHREF1, DHREF2, DHREF3, DHREF4, DHREF5, DHCTNF, DHSSKU, DHRCEX, DHCREX, DHSTAT, DHFUNC, DHNUMD, DHFWID, DHFWFL, DHSWAP
FROM WM_TABLEAU_REPORTING.WMS_TABLES.IOINPT00;

USE DATABASE e1_PRODUCTION;
SELECT * FROM e1.F4311 LIMIT 10;
---- wrong lot process type
select PDMCU BU, PDLITM Item,   IBSRCE Lot_Process,  MIN(pdupmj) Last_DATE
from e1.F4311 inner join e1.F4102 on pdmcu=ibmcu and pdlitm = iblitm 
where pdmcu in  ('BDC', 'BD2', 'FL1', 'FL2', 'HD6', 'HD7', 'NDC', 'ON3','PFD','SC1', 'SC2', 'SC3', 'SC4') and 
      pdnxtr='400' and 
	  PDDOCO >0 and 
      PDITM >0 and 
      IBSRCE <> ''
group by PDMCU, PDLITM , IBSRCE 
order by 1, 2;

select  ibmcu BU, ibLITM Item, IBSRCE Lot_Process_type, ibupmj Last_DATE
from e1.F4102 
where ibmcu in  ('BDC', 'BD2', 'FL1', 'FL2', 'HD6', 'HD7', 'NDC', 'ON3','PFD','SC1', 'SC2', 'SC3', 'SC4') AND  
      IBSRCE <> ''
order by 1, 2;
select  count(*)
from e1.F4102 
where ibmcu in  ('BDC', 'BD2', 'FL1', 'FL2', 'HD6', 'HD7', 'NDC', 'ON3','PFD','SC1', 'SC2', 'SC3', 'SC4') AND
      IBSRCE <> '';



------
SELECT * FROM e1.f550006a WHERE gcrefn='FO277136.TXT' AND gcmcu='SC3' AND gc55tset='WMSSHC' ;
SELECT * FROM e1.f550263a LIMIT 10;
SELECT * FROM e1.f550263b LIMIT 10;
SELECT * FROM e1.f550263a WHERE bh55brc='11908830960117879642' LIMIT 10; ---
SELECT * FROM e1.f550263b WHERE bd55brc='11908830960117879642';
SELECT * FROM e1.f550263c WHERE brURRF ='PAR' LIMIT 10;

SELECT a.* FROM e1.f550263a a WHERE bh55bct='RM' AND bhupmj='2023-08-02'; -- totals BY TYPE
SELECT b.* FROM e1.f550263b b WHERE bd55bct='RM' AND bdupmj='2023-08-02'; -- totals BY type
SELECT bh55bct, count(*), min(bhupmj),max(bhupmj) FROM e1.f550263a GROUP BY bh55bct ORDER BY 1; -- totals BY type

SELECT * FROM e1.f41021 LIMIT 10;

----------------------------------------------------------------------------------------------
---   **** Inventory in Primary Location ***                                              ----
----------------------------------------------------------------------------------------------
USE DATABASE e1_PRODUCTION;

SELECT limcu BU, ImLITM "Item", lilocn "Location",  lipqoh "OnHand", IMUOM1 UOM FROM e1.f41021 a INNER JOIN e1.f4101 ON liitm = imitm 
WHERE limcu IN ('SC1','SC2','SC3','SC4','BDC','BD2','ON3','FL1','FL2','FL3','HD6','HD7','PFD','NDC') 
AND lipbin='P'  AND  lipqoh<>0 
ORDER BY 1,2,3;

USE DATABASE e1_PRODUCTION;
SELECT limcu BU, ImLITM Item, lilocn Location,  lipqoh OnHand FROM e1.f41021 a INNER JOIN e1.f4101 ON liitm = imitm 
WHERE limcu IN ('SC1','SC2','SC3','SC4','BDC','BD2','ON3','FL1','FL2','FL3','HD6','HD7','PFD','NDC') 
AND lipbin='P'  AND  lipqoh<>0 --AND lipqoh<>0 
ORDER BY 1,2,3;
-- counter location <>' ' and onhand=0
SELECT limcu,count(*) FROM e1.f41021 INNER JOIN e1.f4101 ON liitm = imitm 
WHERE limcu IN ('SC1','SC2','SC3','SC4','BDC','BD2','ON3','FL1','FL2','FL3','HD6','HD7','PFD','NDC') 
AND lipbin='P' AND lilocn<> '' AND lipqoh<>0 GROUP BY limcu  ORDER BY 1;  --- 

-- counter by user
SELECT limcu,liuser,lipid, count(*) FROM e1.f41021 INNER JOIN e1.f4101 ON liitm = imitm 
WHERE limcu IN ('SC1','SC2','SC3','SC4','BDC','BD2','ON3','FL1','FL2','HD6','HD7','PFD','NDC') AND limcu='SC3'
AND lipbin='P' AND lilocn<> '' AND lipqoh=0 AND liupmj='2024-02-09' GROUP BY limcu, liuser,lipid  ORDER BY 1, 2;

SELECT limcu,liuser,lipid,liupmj,litday, count(*) FROM e1.f41021 INNER JOIN e1.f4101 ON liitm = imitm 
WHERE limcu IN ('SC1','SC2','SC3','SC4','BDC','BD2','ON3','FL1','FL2','HD6','HD7','PFD','NDC') 
AND lipbin='P' AND lilocn<> '' AND lipqoh=0  GROUP BY limcu, liuser,lipid,liupmj,litday  ORDER BY 1, 2; --AND liupmj='2024-02-09'

SELECT limcu,liuser,lipid,liupmj,litday, count(*) FROM e1.f41021 INNER JOIN e1.f4101 ON liitm = imitm 
WHERE limcu IN ('SC1','SC2','SC3','SC4','BDC','BD2','ON3','FL1','FL2','HD6','HD7','PFD','NDC') 
AND lipbin='P' AND lilocn<> '' AND lipqoh=0  GROUP BY limcu, liuser,lipid,liupmj,litday  ORDER BY 1, 2; --AND liupmj='2024-02-09';

USE DATABASE e1_PRODUCTION;
--- lilocn with inventory in primary location
SELECT limcu,count(*) FROM e1.f41021 INNER JOIN e1.f4101 ON liitm = imitm 
WHERE limcu IN ('SC1','SC2','SC3','SC4','BDC','BD2','ON3','FL1','FL2','HD6','HD7','PFD','NDC') 
AND lipbin='P' AND lilocn<> '' AND lipqoh<>0  GROUP BY limcu ORDER BY 1  ;  
;
--- only sc3 *****************************************************************************************************
SELECT  liupmj, litday,liuser,limcu BU, lipqoh OnHand, 
LIPCOM+LIPBCK+LIPREQ+LIQWBO+LIOT1A+LIFUN1+LISCMS+LISREQ+LISQWO+liqttr TotalCom,
ImLITM Item, lilocn Location,  lipcom Commited, lifcom, a.* FROM e1.f41021 a INNER JOIN e1.f4101 ON liitm = imitm 
WHERE limcu IN ('SC1','SC2','SC3','SC4','BDC','BD2','ON3','FL1','FL2','HD6','HD7','PFD','NDC') 
AND lipbin='P'   AND lilocn<>'' --AND limcu='SC3' 
--AND lipqoh<>0 --AND lipcom=0 --- '/AND lipqoh<>0 --AND limcu='SC3' --AND lipcom=0 -- 
--AND LIPCOM+LIPBCK+LIPREQ+LIQWBO+LIOT1A+LIFUN1+LISCMS+LISREQ+LISQWO = 0  
ORDER BY 1 DESC ,2 desc,3;
--*****************************************************************************************************************
--AND (LIPCOM <>0 or LIPBCK <>0 or LIPREQ <>0 or LIQWBO <>0 or LIOT1A <>0 OR LIFUN1 <>0 or LISCMS <>0 or LISREQ <>0 or LISQWO <>0)
--LIPCOM+LIPBCK+LIPREQ+LIQWBO+LIOT1A+LIFUN1+LISCMS+LISREQ+LISQWO TotalCom
-- F4108
SELECT iolotn,iomcu, min(ioupmj),max(ioupmj),count(*) FROM e1.f4108 WHERE iolotn='' GROUP BY iolotn,iomcu LIMIT 10;
SELECT count(*) FROM e1.f4108 a lIMIT 10;
SELECT iolotn,iomcu, a.* FROM e1.f4108 a lIMIT 10;
SELECT iomcu, min(ioupmj),max(ioupmj),count(*) FROM e1.f4108  GROUP BY iomcu ORDER BY 1;

--------  work order en SCx
SELECT  liqowo, liupmj, litday,liuser,limcu BU, lipqoh OnHand, 
LIpcom+LIPBCK+LIPREQ+LIQWBO+LIOT1A+LIFUN1+LISCMS+LISREQ+LISQWO TotalCom,
ImLITM Item, lilocn Location,  lipcom Commited, lifcom, a.* FROM e1.f41021 a INNER JOIN e1.f4101 ON liitm = imitm 
WHERE limcu IN ('SC1','SC2','SC3','SC4') 
AND lipbin='P'   AND liqowo<>0   --AND limcu='SC3' 
--AND lipqoh<>0 --AND lipcom=0 --- '/AND lipqoh<>0 --AND limcu='SC3' --AND lipcom=0 -- 
--AND LIPCOM+LIPBCK+LIPREQ+LIQWBO+LIOT1A+LIFUN1+LISCMS+LISREQ+LISQWO = 0  
ORDER BY 1 DESC ,2 desc,3;

USE DATABASE e1_PRODUCTION;
--- No primary location
SELECT ibmcu BU, IbLITM Item, a.* FROM e1.f4102 a 
WHERE ibitm NOT IN (select liitm FROM e1.f41021 WHERE limcu='BD2' AND lipbin='P')
AND ibmcu IN ('BD2') 
ORDER BY 1, 2 	; --AND ibmcu='SC3';
SELECT * FROM e1.f4102 LIMIT 10;
--**************************************************************************************************************************************************************
USE DATABASE e1_PRODUCTION;
SELECT limcu BU, ImLITM Item, lilocn Location,  lipqoh OnHand, lipcom Commited, lifcom,liqwbo, a.* 
FROM e1_PRODUCTION.e1.f41021 a INNER JOIN e1_PRODUCTION.e1.f4101 ON liitm = imitm 
WHERE limcu IN ('SC1','SC2','SC3','SC4','BDC','BD2','ON3','FL1','FL2','FL3','HD6','HD7','PFD','NDC') 
AND lipbin='P'  AND lilocn<>'' --AND lipqoh<>0  --AND lipcom=0  
--AND (LIPCOM <>0 or LIPBCK <>0 or LIPREQ <>0 or LIQWBO <>0 or LIOT1A <>0 OR LIFUN1 <>0 or LISCMS <>0 or LISREQ <>0 or LISQWO <>0)
ORDER BY 1,2,3;

SELECT limcu BU, ImLITM Item, lilocn Location,  lipqoh OnHand, lipcom Commited, lifcom,liqwbo, a.* 
FROM e1_PRODUCTION.e1.f41021 a INNER JOIN e1_PRODUCTION.e1.f4101 ON liitm = imitm 
WHERE limcu IN ('SC1','SC2','SC3','SC4','BDC','BD2','ON3','FL1','FL2','FL3','HD6','HD7','PFD','NDC') 
AND lipbin='P'  AND lipqoh<>0  --AND lipcom=0  
--AND (LIPCOM <>0 or LIPBCK <>0 or LIPREQ <>0 or LIQWBO <>0 or LIOT1A <>0 OR LIFUN1 <>0 or LISCMS <>0 or LISREQ <>0 or LISQWO <>0)
ORDER BY 1,2,3;
--**************************************************************************************************************************************************************

SELECT limcu BU, liupmj Date , litday Time, ImLITM Item, lipbin, lilocn Location 
FROM e1_PRODUCTION.e1.f41021 a INNER JOIN e1_PRODUCTION.e1.f4101 ON liitm = imitm 
WHERE limcu IN ('SC1','SC2','SC3','SC4','BDC','BD2','ON3','FL1','FL2','FL3','HD6','HD7','PFD','NDC') 
AND lipbin='P'  AND lilocn<>'' --AND lipqoh<>0  --AND lipcom=0  
--AND (LIPCOM <>0 or LIPBCK <>0 or LIPREQ <>0 or LIQWBO <>0 or LIOT1A <>0 OR LIFUN1 <>0 or LISCMS <>0 or LISREQ <>0 or LISQWO <>0)
ORDER BY 1,2,3;


----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------

---item NDC
SELECT * FROM e1_PRODUCTION.f4102 LIMIT 10;
SELECT ibitm, iblitm FROM e1.f4102 WHERE ibmcu='NDC' ORDER BY 2;
--- items WM
SELECT * FROM WMNDC_PRODUCTION.WMS.STstyl00 LIMIT 10;
-- NDC items in WM but not in E1
SELECT 'NDC',ststyl||stssfx||stcolr||stcsfx||stsdim FROM WMNDC_PRODUCTION.WMS.STstyl00 a 
WHERE ststyl||stssfx||stcolr||stcsfx||stsdim NOT IN (SELECT iblitm FROM e1_PRODUCTION.E1.f4102  WHERE ibmcu='NDC')
ORDER BY 1;
-- SC1
SELECT 'SC1',ststyl||stssfx||stcolr||stcsfx||stsdim FROM WMSC1_PRODUCTION.WMS.STstyl00 a 
WHERE ststyl||stssfx||stcolr||stcsfx||stsdim NOT IN (SELECT iblitm FROM e1_PRODUCTION.E1.f4102  WHERE ibmcu IN ('SC1','SC2','SC3','SC4'))
ORDER BY 1;
-- BDC
SELECT 'BDC',ststyl||stssfx||stcolr||stcsfx||stsdim FROM WMBD1_PRODUCTION.WMS.STstyl00 a 
WHERE ststyl||stssfx||stcolr||stcsfx||stsdim NOT IN (SELECT iblitm FROM e1_PRODUCTION.E1.f4102  WHERE ibmcu IN ('BDC','BD2'))
ORDER BY 1;
-- RIO
SELECT 'HN5',ststyl||stssfx||stcolr||stcsfx||stsdim FROM WMRIO_PRODUCTION.WMS.STstyl00 a 
WHERE ststyl||stssfx||stcolr||stcsfx||stsdim NOT IN (SELECT iblitm FROM e1_PRODUCTION.E1.f4102  WHERE ibmcu IN ('HD6','HD7','PFD'))
ORDER BY 1;
-- JAX
SELECT 'JAX',ststyl||stssfx||stcolr||stcsfx||stsdim FROM WMFL1_PRODUCTION.WMS.STstyl00 a 
WHERE ststyl||stssfx||stcolr||stcsfx||stsdim NOT IN (SELECT iblitm FROM e1_PRODUCTION.E1.f4102  WHERE ibmcu IN ('FL1','FL2'))
ORDER BY 1;
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------one query all DCs -  items in WM but not in E1
SELECT 'NDC' BU,ststyl||stssfx||stcolr||stcsfx||stsdim Item FROM WMNDC_PRODUCTION.WMS.STstyl00 a WHERE ststyl||stssfx||stcolr||stcsfx||stsdim NOT IN (SELECT iblitm FROM e1_PRODUCTION.E1.f4102  WHERE ibmcu='NDC')
UNION ALL 
SELECT 'SC1' BU,ststyl||stssfx||stcolr||stcsfx||stsdim Item FROM WMSC1_PRODUCTION.WMS.STstyl00 a WHERE ststyl||stssfx||stcolr||stcsfx||stsdim NOT IN (SELECT iblitm FROM e1_PRODUCTION.E1.f4102  WHERE ibmcu IN ('SC1','SC2','SC3','SC4'))
UNION ALL 
SELECT 'BDC' BU,ststyl||stssfx||stcolr||stcsfx||stsdim Item FROM WMBD1_PRODUCTION.WMS.STstyl00 a WHERE ststyl||stssfx||stcolr||stcsfx||stsdim NOT IN (SELECT iblitm FROM e1_PRODUCTION.E1.f4102  WHERE ibmcu IN ('BDC','BD2'))
UNION ALL 
SELECT 'HD5' BU,ststyl||stssfx||stcolr||stcsfx||stsdim Item FROM WMRIO_PRODUCTION.WMS.STstyl00 a WHERE ststyl||stssfx||stcolr||stcsfx||stsdim NOT IN (SELECT iblitm FROM e1_PRODUCTION.E1.f4102  WHERE ibmcu IN ('HD6','HD7','PFD'))
UNION ALL 
SELECT 'JAX' BU,ststyl||stssfx||stcolr||stcsfx||stsdim Item FROM WMFL1_PRODUCTION.WMS.STstyl00 a WHERE ststyl||stssfx||stcolr||stcsfx||stsdim NOT IN (SELECT iblitm FROM e1_PRODUCTION.E1.f4102  WHERE ibmcu IN ('FL1','FL2','FL3'))
ORDER BY 1,2;
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

----items not in E1 SC2

-- FL1
SELECT 'JAX',SKSTYL||SKSSFX||SKCOLR||SKCSFX||SKSDIM  FROM WMFL1_PRODUCTION.WMS.Skinvn00 WHERE skaohq+skuohq <> 0
AND SKSTYL||SKSSFX||SKCOLR||SKCSFX||SKSDIM  NOT IN (SELECT iblitm FROM e1_PRODUCTION.E1.f4102  WHERE ibmcu IN ('FL1') ) 
ORDER BY 1;


-- SC1
SELECT 'SC1',SKSTYL||SKSSFX||SKCOLR||SKCSFX||SKSDIM  FROM WMSC1_PRODUCTION.WMS.Skinvn00 WHERE skaohq+skuohq <> 0
AND SKSTYL||SKSSFX||SKCOLR||SKCSFX||SKSDIM  NOT IN (SELECT iblitm FROM e1_PRODUCTION.E1.f4102  WHERE ibmcu IN ('SC2') ) 
ORDER BY 1;

-- NDC
SELECT 'NDC',SKSTYL||SKSSFX||SKCOLR||SKCSFX||SKSDIM  FROM WMNDC_PRODUCTION.WMS.Skinvn00 WHERE skaohq+skuohq <> 0
AND SKSTYL||SKSSFX||SKCOLR||SKCSFX||SKSDIM  NOT IN (SELECT iblitm FROM e1_PRODUCTION.E1.f4102  WHERE ibmcu IN ('NDC') ) 
ORDER BY 1;

-- RIO
SELECT 'HN5',SKSTYL||SKSSFX||SKCOLR||SKCSFX||SKSDIM  FROM WMRIO_PRODUCTION.WMS.Skinvn00 WHERE skaohq+skuohq <> 0
AND SKSTYL||SKSSFX||SKCOLR||SKCSFX||SKSDIM  NOT IN (SELECT iblitm FROM e1_PRODUCTION.E1.f4102  WHERE ibmcu IN ('HD7') ) 
ORDER BY 1;

SELECT * FROM WMSC1_PRODUCTION.WMS.Skinvn00 WHERE SKSTYL||SKSSFX||SKCOLR||SKCSFX||SKSDIM in ('125188ASM0', '186036AMD0MHN');                                          



--- JAX counter
SELECT count(*) FROM WMFL1_PRODUCTION.WMS.STstyl00 a 
WHERE 'JAX',ststyl||stssfx||stcolr||stcsfx||stsdim NOT IN (SELECT iblitm FROM e1_PRODUCTION.E1.f4102  WHERE ibmcu IN ('FL1','FL2'))
ORDER BY 1;

USE DATABASE e1_PRODUCTION;
SELECT * FROM e1.f41021 WHERE limcu IN ('SC1','SC2','SC3','SC4','BDC'.'BD2','ON3','FL1','FL2','') AND lipbin='P' AND lipqoh<>0 LIMIT 1000;
SELECT * FROM e1.f41021 WHERE lilocn='UNITEDSATES' ;  --16522501
SELECT * FROM e1.f55151 WHERE ed55barc='002218665016800452' LIMIT 10;

SELECT * FROM e1.f41021 WHERE limcu IN ('BDC') AND lipbin='S' AND lipqoh<>0 AND lilocn LIKE 'QH%' LIMIT 1000;
SELECT * FROM e1.f4102 WHERE ibmcu='BDC';
SELECT * FROM e1.f41021 WHERE limcu IN ('BDC') AND lipbin='S' AND lipqoh<>0 AND lilocn LIKE 'QH%' LIMIT 1000;
SELECT limcu, lilocn, ImLITM, lipqoh FROM e1.f41021 INNER JOIN e1.f4101 ON liitm = imitm 
WHERE limcu='BDC' AND lipbin='S' AND lipqoh<>0 AND lilocn LIKE 'QH%'  ORDER BY 1,2,3;
---QH for BDC
USE DATABASE e1_PRODUCTION;
SELECT limcu, lilocn, sum(lipqoh) FROM e1.f41021  
WHERE limcu='BDC' AND lipbin='S' AND lipqoh<>0 AND lilocn LIKE 'QH%'  
GROUP BY limcu, lilocn ORDER BY 1,2;


SELECT ga55whse, ga55proc, count(*) FROM e1.f550207a GROUP BY ga55whse, ga55proc ORDER BY 1,2;

SELECT gcrefn, a.*  
FROM e1.F550207C a 
WHERE gcmcu='SC2' AND gcrefn BETWEEN 'FO277136.TXT' AND 'FO278326.TXT';

--- orders with invoicing----------------------------------------------------------------------------------------------
USE DATABASE e1_PRODUCTION;
SELECT * FROM e1.f550006a a LIMIT 10;
SELECT a.gcmcu, a.gc55tset, count(*) "Records" 
FROM e1.f550006a a
WHERE a.gc55upmjo < '2023-10-01' AND gcmcu IN  ('BDC', 'BD2', 'FL1', 'FL2', 'HD6', 'HD7', 'NDC', 'ON3','PFD','SC1', 'SC2', 'SC3', 'SC4') AND gc55tset IN ('WMSPIX', 'WMSSIF', 'WMSSHC', 'WMSSIG', 'WMSPOR', 'WMSITM', 'WMSSYN', 'WMSWOD', 'WMSXRF')--('ITMTORP','ITMTOWM', 'CCP')
GROUP BY a.gcmcu, a.gc55tset
ORDER BY 2,1; ---2,1;
-----('WMSPIX', 'WMSSIF', 'WMSSHC', 'WMSSIG', 'WMSPOR', 'WMSITM', 'WMSSYN', 'WMSWOD', 'WMSXRF')

SELECT a.gcmcu, a.gcrefn, count(*) "R550207C records" 
FROM e1.f550006a a
INNER JOIN e1.F550207C c ON a.gccstpo=c.gcmcu AND a.gcrefn=c.gcrefn  
WHERE  a.gcmcu='SC3' AND a.gc55tset='WMSSHC' AND a.gcrefn BETWEEN 'FO277136.TXT' AND 'FO278326.TXT'
GROUP BY a.gcmcu, a.gcrefn
ORDER BY 1, 2;
--SC3	FO278230.TXT	646
--SC3	FO278283.TXT	23
--SC3	FO278284.TXT	41
--SC3	FO278313.TXT	544
--SC3	FO278326.TXT	131

--- orders to be canceled
USE DATABASE e1_PRODUCTION;
SELECT a.gcmcu, a.gcrefn, count(*) "R550207C records" 
FROM e1.f550006a a
LEFT JOIN e1.F550207C c ON a.gccstpo=c.gcmcu AND a.gcrefn=c.gcrefn  
WHERE  c.gcmcu IS NULL AND c.gcrefn IS NULL  AND a.gcmcu='SC3' AND a.gcrefn BETWEEN 'FO284977.TXT' AND 'FO285047.TXT' ---'FO277136.TXT' AND 'FO278326.TXT'
GROUP BY a.gcmcu, a.gcrefn
ORDER BY 1, 2;


----looking WMS Sc2
SELECT * FROM WMSC1_PRODUCTION.WMS.O2OPUT00;
SELECT o2bctn, count(*) FROM WMSC1_PRODUCTION.WMS.O2OPUT00 WHERE O2BCTN IN (
'0500099484','0500099486','0500099488','0500099490','0500099492','0500099494','0500099496','0500099498','0500099500','0500099502','0500099504','0500099506','0500099508','0500099510','0500099512','0500099514','0500099516','0500099518','0500099520','0500099522','0500099524','0500099526','0500099528','0500099530','0500099532','0500099534','0500099536','0500099538','0500099540','0500099542','0500099544','0500099546','0500099548','0500099550','0500099552','0500099554','0500099556','0500099558','0500099560','0500099562','0500099564','0500099566','0500099568','0500099570','0500099572','0500099574','0500099576','0500099578','0500099580','0500099582','0500099584','0500099586','0500099588','0500099590','0500099592','0500099594','0500099596','0500099598','0500099600','0500099602','0500099604','0500099606','0500099608','0500099610','0500099612','0500099614','0500099616','0500099618','0500099620','0500099622','0500099624','0500099626','0500099628','0500099630','0500099632','0500099634','0500099636','0500099638','0500099640','0500099642','0500099644','0500099646','0500099648','0500099650','0500099652','0500099654','0500099656','0500099658','0500099660','0500099662','0500099664','0500099666','0500099668','0500099670','0500099672','0500099674','0500099676','0500099678','0500099680','0500099682','0500099684','0500099686','0500099688','0500099690','0500099692','0500099694','0500099696','0500099698','0500099700','0500099702','0500099704','0500099706','0500099708','0500099710','0500099712','0500099714','0500099716','0500099718','0500099720','0500099722','0500099724','0500099726','0500099728','0500099730','0500099732','0500099734','0500099736','0500099738','0500099740','0500099742','0500099744','0500099746','0500099748','0500099750','0500099752','0500099754','0500099756','0500099758','0500099760','0500099762','0500099764','0500099766','0500099768','0500099770','0500099772','0500099774','0500099776','0500099778','0500099780','0500099782','0500099784','0500099786','0500099788','0500099790','0500099792','0500099794','0500099796','0500099798','0500099800','0500099802','0500099804','0500099806','0500099808','0500099810','0500099812','0500099814','0500099816','0500099818','0500099820','0500099822','0500099824','0500099826','0500099828','0500099830','0500099832','0500099834','0500099836','0500099838','0500099840','0500099842','0500099844','0500099846','0500099848','0500099850','0500099852','0500099854','0500099856','0500099858','0500099860','0500099862','0500099864','0500099866','0500099868','0500099870','0500099872','0500099874','0500099876','0500099878','0500099880','0500099882','0500099884','0500099886','0500099888','0500099890','0500099892','0500099894','0500099896','0500099898','0500099900','0500099902','0500099904','0500099906','0500099908','0500099910','0500099912','0500099914','0500099916','0500099918','0500099920','0500099922','0500099924','0500099926','0500099928','0500099930','0500099932','0500099934','0500099936','0500099938','0500099940','0500099942','0500099944','0500099946','0500099948','0500099950','0500099952','0500099954','0500099957','0500099958','0500099960','0500099963','0500099964','0500099967','0500099968','0500099971','0500099972','0500099975','0500099976','0500099979','0500099981','0500099982','0500099985','0500099986','0500099989','0500099990','0500099993','0500099994','0500099997','0500099998','0500100001','0500100002','0500100005','0500100006','0500100009','0500100010','0500100013','0500100014','0500100017','0500100018','0500100021','0500100022','0500100025','0500100026','0500100029','0500100030','0500100033','0500100034','0500100037','0500100038','0500100041','0500100042','0500100045','0500100046','0500100049','0500100050','0500100053','0500100054','0500100056','0500100058','0500100061','0500100062','0500100064','0500100066','0500100068','0500100071','0500100072','0500100075','0500100076','0500100078','0500100080','0500100082','0500100085','0500100086','0500100088','0500100090','0500100093','0500100094','0500100097','0500100098','0500100101','0500100102','0500100105','0500100106','0500100109','0500100110','0500100112','0500100114','0500100117','0500100118','0500100121','0500100122','0500100125','0500100126','0500100129','0500100130','0500100133','0500100134','0500100136','0500100138','0500100140','0500100142','0500100144','0500100146','0500100148','0500100150','0500100152','0500100154','0500100156','0500100158','0500100160','0500100162','0500100164','0500100166','0500100168','0500100170','0500100172','0500100174','0500100176','0500100178','0500100180','0500100182','0500100184','0500100186','0500100188','0500100190','0500100192','0500100194','0500100196','0500100198','0500100200','0500100202','0500100204','0500100206','0500100208','0500100210','0500100212','0500100214','0500100216','0500100218','0500100220','0500100222','0500100224','0500100226','0500100228','0500100230','0500100232','0500100234','0500100236','0500100238','0500100240','0500100242','0500100244','0500100246','0500100248','0500100250','0500100252','0500100254','0500100256','0500100258','0500100260','0500100262','0500100264','0500100266','0500100268','0500100270','0500100272','0500100274','0500100276','0500100278','0500100280','0500100282','0500100284','0500100286','0500100288','0500100290','0500100292','0500100294','0500100296','0500100298','0500100300','0500100302','0500100304','0500100306','0500100308','0500100310','0500100312','0500100314','0500100316','0500100318','0500100320','0500100322','0500100324','0500100326','0500100328','0500100330','0500100332','0500100334','0500100337','0500100339','0500100341','0500100343','0500100345','0500100347','0500100349','0500100351','0500100353','0500100355','0500100357','0500100359','0500100361','0500100363','0500100365','0500100367','0500100369','0500100371','0500100373','0500100375','0500100377','0500100379','0500100381','0500100383','0500100385','0500100387','0500100389','0500100391','0500100393','0500100395','0500100397','0500100399','0500100401','0500100403','0500100405','0500100407','0500100409','0500100411','0500100413','0500100415','0500100417','0500100419','0500100421','0500100423','0500100425','0500100427','0500100429','0500100431','0500100433','0500100435','0500100437','0500100439','0500100441','0500100443','0500100445','0500100447','0500100449','0500100451','0500100453','0500100455','0500100457','0500100459','0500100461','0500100463','0500100465','0500100467','0500100469','0500100471','0500100473','0500100475','0500100477','0500100479','0500100481','0500100483','0500100485','0500100487','0500100489','0500100491','0500100493','0500100495','0500100497','0500100499','0500100501','0500100503','0500100505','0500100507','0500100509','0500100511','0500100513','0500100515','0500100517','0500100519','0500100521','0500100523','0500100525','0500100527','0500100529','0500100531','0500100533','0500100535','0500100537','0500100539','0500100541','0500100543','0500100545','0500100547','0500100549','0500100551','0500100553','0500100555','0500100557','0500100559','0500100561','0500100563','0500100565','0500100567','0500100569','0500100571','0500100573','0500100575','0500100577','0500100579','0500100581','0500100583','0500100585','0500100587','0500100589','0500100591','0500100593','0500100595','0500100597','0500100599','0500100601','0500100603','0500100605','0500100607','0500100609','0500100611','0500100613','0500100615','0500100617','0500100619','0500100621','0500100623','0500100625','0500100627','0500100629','0500100631','0500100633','0500100635','0500100637','0500100639','0500100641','0500100643','0500100645','0500100647','0500100649','0500100651','0500100653','0500100655','0500100657','0500100659','0500100661','0500100663','0500100665','0500100667','0500100669','0500100672','0500100674','0500100675','0500100678','0500100679','0500100681','0500100684','0500100685','0500100688','0500100689','0500100692','0500100693','0500100695','0500100698','0500100699','0500100702','0500100703','0500100705','0500100707','0500100710','0500100711','0500100713','0500100716','0500100717','0500100720','0500100721','0500100724','0500100725','0500100728','0500100729','0500100732','0500100733','0500100736','0500100737','0500100740','0500100741','0500100744','0500100745','0500100747','0500100749','0500100751','0500100753','0500100755','0500100758','0500100759','0500100762','0500100763','0500100765','0500100767','0500100769','0500100772','0500100773','0500100776','0500100777','0500100780','0500100781','0500100783','0500100786','0500100787','0500100790','0500100791','0500100794','0500100795','0500100798','0500100799','0500100802','0500100803','0500100806','0500100807','0500100810','0500100811','0500100814','0500100815','0500100818','0500100819','0500100822','0500100823','0500100826','0500100827','0500100830','0500100831','0500100834','0500100835','0500100838','0500100839','0500100842','0500100843','0500100846','0500100847','0500100850','0500100851','0500100853','0500100856','0500100857','0500100860','0500100861','0500100863','0500100866','0500100867','0500100870','0500100871','0500100874','0500100875','0500100878','0500100879','0500100882','0500100883','0500100886','0500100887','0500100890','0500100891','0500100894','0500100895','0500100898','0500100899','0500100902','0500100904','0500100905','0500100908','0500100909','0500100912','0500100913','0500100916','0500100917','0500100920','0500100921','0500100923','0500100925','0500100927','0500100930','0500100931','0500100934','0500100935','0500100938','0500100940','0500100941','0500100944','0500100945','0500100948','0500100949','0500100952','0500100953','0500100956','0500100957','0500100960','0500100961','0500100963','0500100966','0500100967','0500100970','0500100971','0500100974','0500100975','0500100978','0500100979','0500100982','0500100983','0500100986','0500100987','0500100990','0500100991','0500100994','0500100995','0500100998','0500100999','0500101002','0500101003','0500101006','0500101007','0500101010','0500101011','0500101014','0500101015','0500101018','0500101019','0500101022','0500101023','0500101025','0500101027','0500101030','0500101031','0500101034','0500101035','0500101038','0500101039','0500101042','0500101043','0500101046','0500101047','0500101050','0500101051','0500101054','0500101055','0500101057','0500101060','0500101061','0500101064','0500101065','0500101068','0500101069','0500101072','0500101073','0500101076','0500101077','0500101080','0500101081','0500101084','0500101085','0500101088','0500101089','0500101092','0500101093','0500101096','0500101097','0500101100','0500101101','0500101104','0500101105','0500101108','0500101109','0500101112','0500101113','0500101116','0500101117','0500101120','0500101121','0500101124','0500101125','0500101128','0500101129','0500101132','0500101133','0500101136','0500101137','0500101140','0500101141','0500101144','0500101145','0500101148','0500101149','0500101152','0500101153','0500101156','0500101157','0500101160','0500101161','0500101164','0500101165','0500101168','0500101169','0500101172','0500101173','0500101175','0500101177','0500101180','0500101181','0500101184','0500101185','0500101188','0500101189','0500101192','0500101193','0500101196','0500101197','0500101200','0500101201','0500101204','0500101205','0500101208','0500101209','0500101212','0500101213','0500101216','0500101217','0500101220','0500101221','0500101224','0500101225','0500101228','0500101229','0500101232','0500101233','0500101236','0500101237','0500101240','0500101241','0500101244','0500101245','0500101248','0500101249','0500101252','0500101253','0500101256','0500101257','0500101260','0500101261','0500101263','0500101265','0500101267','0500101269','0500101271','0500101273','0500101275','0500101277','0500101279','0500101281','0500101283','0500101285','0500101287','0500101289','0500101291','0500101293','0500101295','0500101297','0500101299','0500101301','0500101303','0500101305','0500101307','0500101309','0500101311','0500101313','0500101315','0500101317','0500101319','0500101321','0500101323','0500101325','0500101327','0500101329','0500101331','0500101333','0500101335','0500101337','0500101339','0500101341','0500101343','0500101345','0500101347','0500101349','0500101351','0500101353','0500101355','0500101357','0500101359','0500101361','0500101363','0500101365','0500101367','0500101369','0500101371','0500101373','0500101375','0500101377','0500101379','0500101381','0500101383','0500101385','0500101387','0500101389','0500101391','0500101393','0500101395','0500101397','0500101399','0500101401','0500101403','0500101405','0500101407','0500101409','0500101411','0500101413','0500101415','0500101417','0500101419','0500101421','0500101423','0500101425','0500101427','0500101429','0500101431','0500101433','0500101435','0500101437','0500101439','0500101441','0500101443','0500101445','0500101447','0500101449','0500101451','0500101453','0500101455','0500101457','0500101459','0500101461','0500101463','0500101465','0500101467','0500101469','0500101471','0500101473','0500101475','0500101477','0500101479','0500101481','0500101483','0500101485','0500101487','0500101489','0500101491','0500101493','0500101495','0500101497','0500101499','0500101501','0500101503','0500101505','0500101507','0500101509','0500101511','0500101513','0500101515','0500101517','0500101519','0500101521','0500101523','0500101525','0500101527','0500101529','0500101531','0500101533','0500101535','0500101537','0500101539','0500101541','0500101543','0500101545','0500101547','0500101549','0500101551','0500101553','0500101555','0500101557','0500101559','0500101561','0500101563','0500101565','0500101567','0500101569','0500101571','0500101573','0500101575','0500101577','0500101579','0500101581','0500101583','0500101585','0500101587','0500101589','0500101591','0500101593','0500101595','0500101597','0500101599','0500101601','0500101603','0500101605','0500101607','0500101609','0500101611','0500101613','0500101615','0500101617','0500101619','0500101621','0500101623','0500101625','0500101627','0500101629','0500101631','0500101632','0500101634','0500101636','0500101637','0500101640','0500101642','0500101643','0500101644','0500101646','0500101647','0500101649','0500101650','0500101652'
)
GROUP BY o2bctn
ORDER BY 1
;

SELECT gcrefn, a.*  
FROM e1.F550207C a 
WHERE gcmcu='SC2' AND gcrefn BETWEEN 'FO277136.TXT' AND 'FO278326.TXT';

-- on3 
SELECT count(*)
FROM E1_PRODUCTION.E1.F4102 a JOIN E1_PRODUCTION.E1.F4102 b ON a.ibmcu=b.ibmcu AND a.ibitm=b.ibitm 
WHERE a.ibmcu='FL1' AND ibitm>0 AND ibstkt IN ('S', 'U', 'O', 'P') AND ibsrp8 IN ('FGR', 'FGV', 'SGR','DS','FGA');

SELECT count(*)
FROM E1_PRODUCTION.E1.F4102 a  
WHERE a.ibmcu='FL1' AND ibitm NOT IN (SELECT b.ibitm FROM E1_PRODUCTION.E1.F4102 b WHERE b.ibmcu='FL2');
SELECT count(*)
FROM E1_PRODUCTION.E1.F4102 a  
WHERE a.ibmcu='FL2' AND ibitm NOT IN (SELECT b.ibitm FROM E1_PRODUCTION.E1.F4102 b WHERE b.ibmcu='FL1');

SELECT count(*)
FROM E1_PRODUCTION.E1.F4102 a  
WHERE a.ibmcu='FL1' AND ibitm IN (SELECT b.ibitm FROM E1_PRODUCTION.E1.F4102 b WHERE b.ibmcu='FL2');
SELECT count(*)
FROM E1_PRODUCTION.E1.F4102 a  
WHERE a.ibmcu='FL2' AND ibitm IN (SELECT b.ibitm FROM E1_PRODUCTION.E1.F4102 b WHERE b.ibmcu='FL1');
SELECT count(*)
FROM E1_PRODUCTION.E1.F4102 a  
WHERE a.ibmcu='FL2' AND ibitm NOT IN (SELECT b.ibitm FROM E1_PRODUCTION.E1.F4102 b WHERE b.ibmcu='FL1');
SELECT iblitm, IBSTKT 
FROM E1_PRODUCTION.E1.F4102 a  
WHERE a.ibmcu='FL2' AND ibitm NOT IN (SELECT b.ibitm FROM E1_PRODUCTION.E1.F4102 b WHERE b.ibmcu='FL1') AND IBSTKT <>'O';


SELECT count(*) FROM E1_PRODUCTION.E1.F4102 a  WHERE a.ibmcu='FL1' ;
SELECT count(*) FROM E1_PRODUCTION.E1.F4102 a  WHERE a.ibmcu='FL2' ;

SELECT count(*) FROM E1_PRODUCTION.E1.F4102 a  WHERE a.ibmcu='SC2' ;
SELECT count(*) FROM E1_PRODUCTION.E1.F4102 a  WHERE a.ibmcu='SC3' ;
SELECT count(*)
FROM E1_PRODUCTION.E1.F4102 a  
WHERE a.ibmcu='SC3' AND ibitm IN (SELECT b.ibitm FROM E1_PRODUCTION.E1.F4102 b WHERE b.ibmcu='SC2');






---- PIX in Inventory Synch HD7
SELECT * FROM E1_PRODUCTION.E1.F550246A LIMIT 10;
SELECT pxmcu, px55txtp,px55txcd,px55accd,pxedsp, count(*) FROM E1_PRODUCTION.E1.F550246A 
WHERE pxmcu = 'HD7' AND px55tset='WMSPIX' AND pxrefn IN ('PX795738.TXT','PX795739.TXT','PX795740.TXT') 
GROUP BY pxmcu,px55txtp,px55txcd,px55accd,pxedsp ORDER BY 1,2,3,4,5;


SELECT pxmcu, px55styl||PX55SSFX||px55colr||px55csfx||px55sdim, sum(PX55INVA), count(*) FROM E1_PRODUCTION.E1.F550246A 
WHERE pxmcu = 'HD7' AND px55tset='WMSPIX' AND pxrefn IN ('PX795738.TXT','PX795739.TXT','PX795740.TXT') AND px55txcd='A'
GROUP BY pxmcu,px55styl||PX55SSFX||px55colr||px55csfx||px55sdim ORDER BY 1,2;


------------urab
SELECT DISTINCT 
SDURAB, sdshpn,
TMUPMJ,
TMTDAY,
TO_TIMESTAMP(concat(TMUPMJ,' ', TIME(CONCAT(SUBSTR(LPAD(TMTDAY,6,0),1,2),':',SUBSTR(LPAD(TMTDAY,6,0),3,2),':',SUBSTR(LPAD(TMTDAY,6,0),5,2))))) as concat_date,
TMANCC, sdshan,
ABALPH,
TMVMCU
FROM e1_Production.e1.F4960 f4960
INNER JOIN e1_Production.e1.F4941 ON (RSLDNM=TMLDNM and RSVMCU=TMVMCU)
INNER JOIN e1_Production.e1.F4211 ON (SDSHPN=RSSHPN)
LEFT JOIN e1_production.e1.F0101 ON (ABAN8=SDAN8) 
--WHERE TRIM(TMVMCU) ='NDC'
where TMLDLS = 50 AND tmancc <> sdshan
AND SDURAB >1 AND TMLDNM >1;


-- Group by F4104 X-ref
SELECT ivxrt, count(*) FROM e1_Production.e1.F4104 GROUP BY ivxrt ORDER BY 2 desc;
--20231224
--S		3,816,677
--C		3,229,298
--R		1,507,620
--CS	1,194,511
--UP	  575,225
--GT	  511,386


-- Group by F4211 line type
SELECT SDLNTY , count(*) FROM e1_Production.e1.F4211 GROUP BY SDLNTY ORDER BY 1;
--20231224
--blanks			       66
--Credit		C	      312
--Credit Non-S	CN	      607
--Return NOn-In	CR	   27,270
--Freight		F	       65
--Freight Tr SC	FT	       11
--Intercom N-S	IC	      220
--Non-Stock		N	      740
--Price Discoun	P	        3
--Stock Inv		S	1,689,286
--Stock G/L		SC	   22,359
--Text line		T	    2,184
--Text line UU	TU	        5


SELECT sdmcu,sdurab,sdan8, count(*) FROM e1_Production.e1.F4211 WHERE sdmcu IN ('NDC','SC2','SC3','FL1','FL2','BDC','HD6','HD7') AND GROUP BY sdmcu,sdurab,sdan8 HAVING count(*)>1 ORDER BY 1,2;

SELECT sdmcu,sdurab,min(sdan8),max(sdan8),min(sdan8)-max(sdan8) Dif, count(*) FROM e1_Production.e1.F4211 WHERE sdmcu IN ('NDC','SC2','SC3','FL1','FL2','BDC','HD6','HD7') AND sdopdj>'2023-01-01' AND sdurab<> 0 GROUP BY sdmcu,sdurab HAVING count(*)>1 ORDER BY 1,2;
SELECT * FROM E1_PRODUCTION.E1.F4211 LIMIT 10;
SELECT sdmcu,sdurab,min(sdshan),max(sdshan),min(sdshan)-max(sdshan) Dif, count(*) FROM e1_Production.e1.F4211 WHERE sdmcu IN ('NDC','SC2','SC3','FL1','FL2','BDC','HD6','HD7') AND sdopdj>'2023-01-01' GROUP BY sdmcu,sdurab HAVING dif > 0 ORDER BY 1,2;

--------trims
SELECT * FROM e1_Production.e1.F550263b WHERE bd55bct='RM' LIMIT 10;
SELECT bd55bct, bduom,count(*), min(bdupmj),max(BDUPMJ) FROM e1_Production.e1.F550263b  GROUP BY bd55bct,bduom ORDER BY 1,2; --WHERE bd55bct='RM'

SELECT * FROM e1_Production.e1.f4101 WHERE imlitm='0HA24GAXSJ' LIMIT 10;
SELECT * FROM e1_Production.e1.f41002 WHERE  ummcu='BDC' AND umum ='EA' LIMIT 10;
SELECT * FROM e1_Production.e1.f550023B LIMIT 10;
SELECT * FROM e1_Production.e1.f46091 WHERE idmcu='BDC' LIMIT 10 ;
--------Cube master
SELECT 
ibmcu BU,
iblitm Part_number,
b2.UMCNV1 Units_Per_Case, 
b1.umcnv1 Units_Per_Pallet,
b3.umconv + idgwei Gross_Weight_of_case,  
b3.umconv Net_Weight_of_case,   
bteqty Foot_Print, 
IBSRP3 SIZE,
ibitm ShortItem, 
IBSRP2 Color, 
bt55RPT05 VelocityCode, 
IBSRP1 STYLE, 
bt55RPT01 Product_line,
bt55SC01 Planning_Status,
bt55SC02 Item_ownership,
imdsc1 Description  
FROM e1_Production.e1.f4102 a 
INNER JOIN e1_Production.e1.f4101 a2  ON  a2.imitm=ibitm 
LEFT  JOIN e1_Production.e1.f41002 b1  ON  b1.ummcu=ibmcu AND b1.umitm=ibitm AND b1.umum='PL' AND b1.umrum='BX'
LEFT JOIN e1_Production.e1.f41002 b2  ON  b2.ummcu=ibmcu AND b2.umitm=ibitm AND b2.umum='BX' AND b2.umrum='DZ'
LEFT JOIN e1_Production.e1.f41002 b3  ON  b3.ummcu=ibmcu AND b3.umitm=ibitm AND b3.umum='EA' AND b3.umrum='SP'
LEFT JOIN e1_Production.e1.f550023B c ON  btmcu=ibmcu AND BTitm=ibitm 
LEFT JOIN e1_Production.e1.F46091   d ON  idmcu=ibmcu AND ideqty=bteqty
WHERE ibmcu='BDC' 
;

---Business unit vs A/B
SELECT * FROM E1_PRODUCTION.E1.F0006  WHERE  mcmcu IN ('TX1','NDC','DSV','ANB', 'BD2') LIMIT 10;
SELECT count(*) FROM E1_PRODUCTION.E1.F0006 WHERE mcan8 > 0;
SELECT mcan8, mcmcu,mcrp21 FROM E1_PRODUCTION.E1.F0006 WHERE mcan8 > 0 ORDER BY 1;


----Sets
 SELECT DISTINCT  IXTBM AS "Bill type" , trim(IXKIT) AS "item short",IXKITL AS "Parent SKU",IXCMCU AS "Branch", IXCPNB AS "Line", IXLITM as "Component SKU",IXQNTY AS "Qty/Pack",
 CASE IXUM  WHEN 'EA'  THEN ROUND(IXQNTY/12,4) ELSE ROUND(IXQNTY/12*F1.IBPRP0,4) END AS "Doz",
 CASE IXUM  WHEN 'EA'  THEN ROUND(IXQNTY/F1.IBPRP0,2) ELSE ROUND(IXQNTY/12*F1.IBPRP0/F1.IBPRP0,2) END AS "% of Pack",
 F1.IBPRP0 AS "POS", GD55LDESC AS "Description",IT55RPT02 AS "HTS",
 F1.IBSRP1 AS "Style code",DRDL01 AS "Style Name",F1.IBSRP2 AS "color code" ,F1.IBSRP3 AS "Size code" ,
 F1.IBSTKT AS "Parent Stocking type", F41.IBSTKT AS "Component Stocking type",IXUOM As "Parent UM",IXUM
 FROM E1_PRODUCTION.E1.F4102 F1 LEFT JOIN E1_PRODUCTION.E1.F3002 ON IXKIT=F1.IBITM AND trim(IXMMCU)=trim(F1.IBMCU) 
 JOIN E1_PRODUCTION.E1.F4102 F41 ON F41.IBITM=IXITM AND trim(F41.IBMCU)=trim(IXMMCU) 
 JOIN E1_PRODUCTION.E1.F0005 ON TRIM(DRKY)=TRIM(F1.IBSRP1) AND DRRT ='S1' AND DRSY ='41' 
 JOIN E1_PRODUCTION.E1.F550023A ON F41.IBITM=ITITM  
 JOIN E1_PRODUCTION.E1.f550076E ON TRIM(F41.IBSRP1)= TRIM(GDSRP1) AND TRIM(F41.IBSRP2)=TRIM(GDSRP2)
 WHERE IXTBM IN ('M') AND IXEFFT>='2050-12-31' AND F1.IBPRP2 IN ('FGR') AND F41.IBPRP2 IN ('SWG','FGA','FGR') AND GDLNGP IN ('')
 AND F1.IBMCU IN ('COST','CBDT', 'SC2','FL1') ; ---AND ixkitl=1196279;

-- only FL1 active 
 SELECT ibitm, ibstDISTINCT  IXTBM AS "Bill type" , trim(IXKIT) AS "item short",IXKITL AS "Parent SKU",IXCMCU AS "Branch", IXCPNB AS "Line", IXLITM as "Component SKU",IXQNTY AS "Qty/Pack",
 CASE IXUM  WHEN 'EA'  THEN ROUND(IXQNTY/12,4) ELSE ROUND(IXQNTY/12*F1.IBPRP0,4) END AS "Doz",
 CASE IXUM  WHEN 'EA'  THEN ROUND(IXQNTY/F1.IBPRP0,2) ELSE ROUND(IXQNTY/12*F1.IBPRP0/F1.IBPRP0,2) END AS "% of Pack",
 F1.IBPRP0 AS "POS", GD55LDESC AS "Description",IT55RPT02 AS "HTS",
 F1.IBSRP1 AS "Style code",DRDL01 AS "Style Name",F1.IBSRP2 AS "color code" ,F1.IBSRP3 AS "Size code" ,
 F1.IBSTKT AS "Parent Stocking type", F41.IBSTKT AS "Component Stocking type",IXUOM As "Parent UM",IXUM
 FROM E1_PRODUCTION.E1.F4102 F1 LEFT JOIN E1_PRODUCTION.E1.F3002 ON IXKIT=F1.IBITM AND trim(IXMMCU)=trim(F1.IBMCU) 


SELECT * FROM  E1_PRODUCTION.E1.F550422S
WHERE SIMCU='HD7' and
SI55ASN=19123808 and
SISPID='0019123808';

SELECT * FROM  E1_PRODUCTION.E1.F550422S WHERE SIMCU='NDC' AND SI55ASN=1492451;

SELECT DISTINCT sdadtm FROM E1_PRODUCTION.E1.F4211 WHERE SDURAB ='1492451';
SELECT * FROM E1_PRODUCTION.E1.F4961;


--Cycle Count
SELECT * FROM  E1_PRODUCTION.E1.F4141 WHERE pjcyno=1001964 AND (PJTQOH <>0 OR PJTQCT <>0)
LIMIT 10;

SELECT pjmcu,sum(pjtqoh), sum(pjtqct)
FROM  E1_PRODUCTION.E1.F4141 
WHERE pjcyno=1001964
GROUP BY pjmcu
ORDER BY 1;

--- V550207F
SELECT *jmcu,sum(pjtqoh), sum(pjtqct)
FROM  E1_PRODUCTION.E1.F4141 
WHERE pjcyno=1001964
GROUP BY pjmcu
ORDER BY 1;

---Lot
USE DATABASE e1_PRODUCTION;
select  ibmcu, ibsrce, count(*)
from e1.F4102 
where ibmcu in  ('BDC',  'FL1', 'FL2', 'HD6', 'HD7', 'NDC', 'BD2','ON3','PFD','SC1', 'SC2', 'SC3', 'SC4') AND
      IBSRCE <> '' GROUP BY ibmcu,IBSRCE ;
      
SELECT bt55itrp, t0.*,t1.*,t2.* 
FROM e1.F4101 T0,e1.F4102 T1,e1.F550023B T2 
WHERE  
(  ( T1.IBMCU = 'BD2' AND T0.IMITM > 0 AND T0.IMSTKT = 'S' AND T1.IBSTKT = 'S'   )  )  AND  --AND T2.BT55ITRP IN  ( 10,22,40,52,80,81,85 )
( T0.IMITM = T1.IBITM AND T0.IMITM = T2.BTITM AND T1.IBMCU = T2.BTMCU )  
ORDER BY T1.IBMCU ASC,T0.IMITM ASC;

-- TAG file
SELECT BT55ITRP, T2.*
FROM e1.F550023B T2 
WHERE  
T2.BTMCU = 'BD2' AND 
T2.BT55ITRP IN  ( '10','22','40','52','80','81','85' )   
;
-- TAG file
SELECT imstkt, count(*) FROM e1.F4101  GROUP BY imstkt ORDER BY 1;
SELECT ibstkt, count(*) FROM e1.F4102 WHERE  ibMCU = 'BD2'   AND 
ibitm IN (SELECT imitm FROM e1.F4101 WHERE imstkt='S' AND imitm >0)
GROUP BY ibstkt ORDER BY 1;

---F4211 and HTS
USE DATABASE e1_PRODUCTION;
SELECT sdurab, sum(sdaexp),sum(sdsoqs) FROM e1.f4211 WHERE sdurab IN (1509083, 1509084) GROUP BY sdurab;
SELECT btlitm,bt55rpt02,btmcu FROM e1.f550023b WHERE bt55rpt02<>'' LIMIT 20;

SELECT sdurab, bt55rpt02, sum(sdaexp) ,sum(sdsoqs)
FROM e1.f4211 
INNER JOIN e1.f550023b ON sdlitm=btlitm
WHERE sdmcu='NDC' AND btmcu='NDC' AND sdurab IN (1509083, 1509084) 
GROUP BY sdurab, bt55rpt02
ORDER BY 1, 2;

--F4211
SELECT sdurab,sddoco,sddcto, sum(sdaexp),sum(sdsoqs) FROM e1.f4211 WHERE sdurab IN (1509084,1512272) GROUP BY sdurab, sddoco, SDDCTO ;
--F42119
SELECT sdurab,sddoco,sddcto, sum(sdaexp),sum(sdsoqs) FROM e1.f42119 WHERE sdurab IN (1509084,1512272) GROUP BY sdurab, sddoco, sddcto;

--F550246
SELECT px55crex, count(*) FROM e1.f550246a GROUP BY px55crex;
SELECT * FROM e1.f550246a LIMIT 10;

---F4111
SELECT * FROM E1.f4111 LIMIT 10;
SELECT * FROM e1.f4111 WHERE ilmcu='HD7' AND ildoco=5138885;
SELECT * FROM e1.f43199 LIMIT 10;
SELECT * FROM e1.f43199 WHERE oldoco=5138885;

----------------------------------------------------------------------------------------------
---   **** F41021 list of locations**                                              ----
----------------------------------------------------------------------------------------------
USE DATABASE e1_PRODUCTION;
SELECT limcu,count(*) FROM e1.f41021 a  
WHERE limcu IN ('SC1','SC2','SC3','SC4','BDC','BD2','ON3','FL1','FL2','HD6','HD7','PFD','NDC') 
AND lipbin='P' --AND LIPQOH <> 0
GROUP BY LIMCU 
order BY 1
;
------------verify all 560 in NDC
SELECT sdurab, sdnxtr, count(*) FROM e1.f4211 
WHERE sdmcu='NDC' AND SDNXTR BETWEEN '560' AND '580' 
GROUP BY sdurab, sdnxtr
;

SELECT sddoco,SDLNID , sdnxtr,sduorg,sdsone, sduom,sdurab FROM e1.f4211 
WHERE sdmcu='NDC' AND SDNXTR BETWEEN '560' AND '560' AND sdsone<>0
ORDER BY sddoco,sdlnid;
-----560, 570
WITH
soLINES AS (
SELECT sdmcu BU, sdurab ASN, sddoco, sdnxtr NextStatus, count(*) Records FROM e1.f4211 
WHERE sdmcu='NDC' AND SDNXTR BETWEEN '560' AND '580' 
GROUP BY sdmcu, sdurab, sddoco,sdnxtr
)
SELECT BU, ASN, sddoco, min(NextStatus), max(NextStatus),count(*) FROM soLINES
GROUP BY bu, asn, sddoco
HAVING count(*) > 1
;

---------------------------------------------------
-- Obsoletes 
----------------------------------------------------
USE DATABASE e1_PRODUCTION;
select count(*)  FROM e1.F4102 where ibmcu in  ('SC2') AND IBSTKT ='O';
select  iblitm Item,ibstkt StockingType FROM e1.F4102 a where ibmcu in  ('SC2') order by 1;

---------------
--- F550247A lines to be reviewedn
----------------
USE DATABASE e1_PRODUCTION;
-- summary
SELECT * FROM e1.f550247a LIMIT 10;
select ctmcu, ctlitm, ct55ref7, ct55aos, count(*), sum(ct55unrc) 
from e1.F550247A 
where ctmcu in ('BDC','BD2','FL1','FL2','FL3','HD6','HD7','PFD','NDC','SC1','SC2','SC3','SC4') 
--and ctrefn='' and ctedsp='X' 
and ctupmj BETWEEN '2024-01-01' AND  '2025-05-01' and ctlitm='1644856'  ---124058
group by ctmcu, ctlitm, ct55ref7, ct55aos
order by 1 desc, 2, 3, 4;


---details
select ctmcu, ct55shmt, ctlitm, ct55ref7, ct55aos, ctupmj,ct55unrc, a.*	 
from e1.F550247A a
where ctmcu in ('BDC','BD2','FL1','FL2','FL3','HD6','HD7','PFD','NDC','SC1','SC2','SC3','SC4') 
and ctrefn='' and ctedsp<>'X' 
and ctupmj BETWEEN '2024-01-01' AND  '2024-05-01'
-- and ctlitm='64W032LMD0'  ---124058
order by 1, 2, 3, 4;
----------------------Review 3190824 OJ
---details
select ctmcu, ct55shmt, ctlitm, ct55ref7, ct55aos, ctupmj,ct55unrc, count(*)	 
from e1.F550247A a
where ctmcu in ('HD7') 
and ctrefn='' and ctedsp<>'X' and ctdoco=3190824 AND ctdcto='OJ'
GROUP BY ctmcu, ct55shmt, ctlitm, ct55ref7, ct55aos, ctupmj,ct55unrc
order by 1, 2, 3, 4;
---total by item
select ctmcu, ct55shmt, ctlitm, count(*), sum(ct55unrc)	 
from e1.F550247A a
where ctmcu in ('HD7') 
and ctrefn='' and ctedsp<>'X' and ctdoco=3190824 AND ctdcto='OJ'
GROUP BY ctmcu, ct55shmt, ctlitm
order by 1, 2, 3, 4;
---total by PO
select ctmcu, ct55shmt, ctrefn, ctedsp,count(*), sum(ct55unrc)	 
from e1.F550247A a
where ctmcu in ('HD7') 
--and ctrefn='' and ctedsp<>'X' 
and ctdoco=3190824 AND ctdcto='OJ'
GROUP BY ctmcu, ct55shmt,ctrefn, ctedsp
order by 1, 2, 3, 4;

----------------PIX
SELECT * FROM E1_PRODUCTION.E1.F550246A WHERE pxedsp='Y' AND pxmcu IN ('SC1','SC2','SC3','SC4') AND px55txtp='300' LIMIT 10;

SELECT px55txtp, px55txcd, px55accd, px55rscd, px55inat, count(*)
FROM E1_PRODUCTION.E1.F550246A 
WHERE pxedsp='Y' AND pxmcu IN ('NDC')  --('SC1','SC2','SC3','SC4')
GROUP BY px55txtp, px55txcd, px55accd, px55inat,px55rscd
ORDER BY 1,2,3,4,5

SELECT * FROM E1_PRODUCTION.E1.F550246A WHERE pxedsp='Y' AND px55rscd='ZA';
SELECT px55txtp, px55txcd, px55accd, px55rscd, px55inat,PXEDSP,a.* FROM E1_PRODUCTION.E1.F550246A a WHERE px55casn='375602177707533002' ORDER BY px55dcr, PX55TCR ;
SELECT px55txtp, px55txcd, px55accd, px55rscd, px55inat,a.* FROM E1_PRODUCTION.E1.F550246A a WHERE px55rscd='ZA' ORDER BY px55dcr, PX55TCR ;

-- from wmndc
SELECT  pxtxtp, pxtxcd, pxaccd, pxrscd, pxinat, a.* FROM WMNDC_PRODUCTION.WMS.PXSTYL00 a where pxcasn='375602177707533002' AND pxdcr ='2024-07-12' LIMIT 10;
SELECT pxtxtp, pxtxcd, pxaccd, pxrscd, pxinat,pxprdt, pxprtm,PXSTYL||PXSSFX,pxcnor, a.* FROM WMNDC_PRODUCTION.WMS.PXSTYL00 a WHERE pxrscd='ZA' AND pxaccd='24' ORDER BY 1,2,3,4,5,6,7,8;
SELECT pxtxtp, pxtxcd, pxaccd, pxrscd, pxinat,count(*) FROM WMNDC_PRODUCTION.WMS.PXSTYL00 a WHERE pxrscd='ZA' 
GROUP BY pxtxtp, pxtxcd, pxaccd, pxrscd, pxinat
ORDER BY 1,2,3,4,5;

SELECT * FROM WMNDC_PRODUCTION.WMS.PXSTYL00 WHERE pxcasn IN (  '375602177707533002','217852113740027055','013092156726453061',
'013182165015367021','014892169937371014','411758676060760002','419042125357933004','013192119172153032',
'010032184118070017','013002131034057050','010022161135570051','014972121717153019','111632146251967053',
'217852113740027012','068032171081553088','538798676277361020','740982113382335043','016492157855535090')
AND pxtxtp='930'
;

SELECT * FROM WMNDC_PRODUCTION.WMS.PXSTYL00 WHERE pxcasn IN (  '004072186124535070') ---AND pxtxtp='618' ---AND pxtxcd='30'
;
-- reason code
------------------------View creation start------------------------------------------------
CREATE OR REPLACE VIEW ITMN_DASHBOARD.ITMNL.ITMNF01 AS
(
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF01_BDC
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF01_JAX where asp_number IN (1, 145)
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF01_HD5
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF01_NDC
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF01_SC1 
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF01_DEV 
);
------------------------View creation end------------------------------------------------
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF01 ;
SELECT * FROM ITMN_DASHBOARD.ITMNL.HVR_ISITMON_DEV_SNOW_ITMN hidsi ;

------------------------View creation start------------------------------------------------
CREATE OR REPLACE VIEW ITMN_DASHBOARD.ITMNL.ITMNF04 AS
(
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF04_BDC
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF04_JAX 
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF04_HD5
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF04_NDC
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF04_SC1 
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF04_DEV 
);
------------------------View creation end------------------------------------------------
SELECT whse, NUMBER_ROWS ,NUMBER_DELETED_ROWS ,* FROM ITMN_DASHBOARD.ITMNL.ITMNF04 WHERE system_table_name='PATRAC00' AND envn='PD'
--GROUP BY whse ORDER BY 1;



------------------------View creation start------------------------------------------------
CREATE OR REPLACE VIEW ITMN_DASHBOARD.ITMNL.ITMNF05 AS
(
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF05_BDC
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF05_JAX 
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF05_HD5
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF05_NDC
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF05_SC1 
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF05_DEV 
);
------------------------View creation end------------------------------------------------
SELECT * FROM ITMN_DASHBOARD.ITMNL.itmnf05;
SELECT * FROM ITMN_DASHBOARD.ITMNL.itmnf05 WHERE LN='PKTOOL';
SELECT * FROM ITMN_DASHBOARD.ITMNL.itmnf05_dev WHERE LN LIKE 'P%' ORDER BY 1;

SELECT whse, count(*) FROM ITMN_DASHBOARD.ITMNL.ITMNF04 WHERE system_table_name='IPPARM00'GROUP BY whse ORDER BY 1;

SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF04 WHERE table_name='IPPARM00'; --'ILLOCN00';
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF03 WHERE system_table_name='IPPARM00'; --'ILLOCN00';




SELECT pxtxtp, pxtxcd, pxaccd,pxinva, pxinat, pxrscd,a.* FROM WMSC1_PRODUCTION.WMS.PXSTYL00 a 
WHERE pxrscd = 'PL'
;
SELECT pxtxtp, pxtxcd, pxaccd,pxinva, pxinat, pxrscd,a.* FROM WMFL1_PRODUCTION.WMS.PXSTYL00 a 
WHERE pxstyl||pxssfx IN ('640036A2X0','640036AMD0') AND pxprdt>='2024-08-10';


SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF01_JAX  ;
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF01 ;

with asps as (
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF01_BDC
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF01_JAX WHERE ASP_STATE IN ('NONE','AVAILABLE')
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF01_HD5
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF01_NDC
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF01_SC1 
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF01_DEV 
)
--select * from asps;
SELECT whse, case when device_description_name is null then '*SYSTEM' else device_description_name
end as name, time_stamp, CAST(TOTAL_CAPACITY/1000 AS integer)                 
Total_capacity_GB, CAST(100*(1-TOTAL_CAPACITY_AVAILABLE/TOTAL_CAPACITY) AS integer) AS Perc_Used 
FROM asps 
ORDER BY 2, 1;


SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF02_NDC WHERE objname LIKE 'NDC%' ;
--------------F02
WITH objectsx AS (
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF02_BDC  
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF02_JAX 
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF02_HD5  
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF02_NDC  
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF02_SC1  
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF02_DEV  
)
SELECT envn, whse, report, time_stamp, count(*) FROM objectsx GROUP BY whse,envn, report, time_stamp ORDER BY 2,3,1 ;
--SELECT envn, whse, report, objlib,time_stamp, count(*) FROM objectsx GROUP BY whse,envn, report,objlib, time_stamp ORDER BY 2,3,1 ;
;
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF02 ;
SELECT count(*) FROM ITMN_DASHBOARD.ITMNL.ITMNF02_DEV ;
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF05 ;

--- verify OPs
SELECT * FROM E1_PRODUCTION.E1.F4311 a LIMIT 10  ;
SELECT pdmcu, pddoco, pddcto,pdlitm, pdnxtr, count(*)
FROM E1_PRODUCTION.E1.F4311 a
WHERE pddcto='OP' AND pddoco IN (
03489114,03489092,03489115,03489086,03489073,03489150,03489104,03489130,03489096,03489151,03489107,03489077,03489155,03489139,03489147,03489061,03489111,03489153,03489057,03489109,03489128,03489172,03489142,03489083,03489067,03489159,03489075,03489137,03489062,03489166,03489082,03489106,03489048,03489124,03489098,03489163,03489088,03489087,03489070,03489059,03489174,03489116,03489113,03489167,03489131,03489093,03489127,03489056,03489140,03489176,03489156,03489053,03489058,03489102,03489178,03489078,03489055,03489072,03489121,03489136,03489175,03489069,03489091,03489157,03489051,03489179,03489105,03489081,03489068,03489164,03489112,03489158,03489110,03489148,03489097,03489071,03489119,03489138,03489049,03489134,03489084,03489170,03489117,03489095,03489101,03489100,03489080,03489066,03489060,03489079,03489162,03489132,03489161,03489169,03489103,03489050,03489065,03489171,03489143,03489173,03489168,03489120,03489089,03489090,03489141,03489099,03489052,03489118,03489152,03489146,03489123,03489108,03489149,03489074,03489144,03489145,03489126,03489129,03489085,03489122,03489125,03489135,03489054,03489094,03489064,03489076,03489160
)
GROUP BY pdmcu, pddoco, pddcto,pdlitm, pdnxtr
ORDER BY 4,1, 2,3,5;

SELECT pdmcu, pdlitm, pdnxtr, count(*)
FROM E1_PRODUCTION.E1.F4311 a
WHERE pddcto='OP' AND pddoco IN (
03489114,03489092,03489115,03489086,03489073,03489150,03489104,03489130,03489096,03489151,03489107,03489077,03489155,03489139,03489147,03489061,03489111,03489153,03489057,03489109,03489128,03489172,03489142,03489083,03489067,03489159,03489075,03489137,03489062,03489166,03489082,03489106,03489048,03489124,03489098,03489163,03489088,03489087,03489070,03489059,03489174,03489116,03489113,03489167,03489131,03489093,03489127,03489056,03489140,03489176,03489156,03489053,03489058,03489102,03489178,03489078,03489055,03489072,03489121,03489136,03489175,03489069,03489091,03489157,03489051,03489179,03489105,03489081,03489068,03489164,03489112,03489158,03489110,03489148,03489097,03489071,03489119,03489138,03489049,03489134,03489084,03489170,03489117,03489095,03489101,03489100,03489080,03489066,03489060,03489079,03489162,03489132,03489161,03489169,03489103,03489050,03489065,03489171,03489143,03489173,03489168,03489120,03489089,03489090,03489141,03489099,03489052,03489118,03489152,03489146,03489123,03489108,03489149,03489074,03489144,03489145,03489126,03489129,03489085,03489122,03489125,03489135,03489054,03489094,03489064,03489076,03489160
)
GROUP BY pdmcu, pdlitm, pdnxtr
ORDER BY 1,2,3;
-------------differences
WITH Combined AS ( 
SELECT COALESCE(ITMN_DASHBOARD.ITMNL.ITMNF02_BDC.OBJNAME , 
				ITMN_DASHBOARD.ITMNL.ITMNF02_NDC.OBJNAME ,
				ITMN_DASHBOARD.ITMNL.ITMNF02_SC1.OBJNAME ) AS objname, 
	ITMN_DASHBOARD.ITMNL.ITMNF02_BDC.OBJNAME AS List1, 
	ITMN_DASHBOARD.ITMNL.ITMNF02_NDC.OBJNAME AS List2, 
	ITMN_DASHBOARD.ITMNL.ITMNF02_SC1.OBJNAME AS List3 
FROM (SELECT objname FROM ITMN_DASHBOARD.ITMNL.ITMNF02_BDC 
      UNION ALL 
      SELECT objname FROM ITMN_DASHBOARD.ITMNL.ITMNF02_NDC 
      UNION ALL 
      SELECT objname FROM ITMN_DASHBOARD.ITMNL.ITMNF02_SC1) AS AllKeys 
      LEFT JOIN ITMN_DASHBOARD.ITMNL.ITMNF02_BDC ON AllKeys.objname = ITMN_DASHBOARD.ITMNL.ITMNF02_BDC.OBJNAME 
      LEFT JOIN ITMN_DASHBOARD.ITMNL.ITMNF02_NDC ON AllKeys.objname = ITMN_DASHBOARD.ITMNL.ITMNF02_NDC.OBJNAME
      LEFT JOIN ITMN_DASHBOARD.ITMNL.ITMNF02_SC1 ON AllKeys.objname = ITMN_DASHBOARD.ITMNL.ITMNF02_SC1.OBJNAME ) 
SELECT objname, List1 BDC, List2 NDC, List3 SC1, 
		CASE WHEN List1 IS NOT NULL THEN 'Yes' ELSE 'No' END AS BDC, 
		CASE WHEN List2 IS NOT NULL THEN 'Yes' ELSE 'No' END AS NDC, 
		CASE WHEN List3 IS NOT NULL THEN 'Yes' ELSE 'No' END AS SC1,
           CASE WHEN List1 IS NOT NULL AND List2 IS NOT NULL AND List3 IS NOT NULL THEN 'Okay' 
           ELSE 'Error' END AS Comment 
FROM Combined ORDER BY 1;

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------differences
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
USE DATABASE e1_PRODUCTION;
WITH Combined AS ( 
SELECT 
		COALESCE(ITMN_DASHBOARD.ITMNL.ITMNF02_DEV.objlib , 
				 ITMN_DASHBOARD.ITMNL.ITMNF02_BDC.objlib ,
				 ITMN_DASHBOARD.ITMNL.ITMNF02_HD5.objlib ,
				 ITMN_DASHBOARD.ITMNL.ITMNF02_JAX.objlib ,
				 ITMN_DASHBOARD.ITMNL.ITMNF02_NDC.objlib ,
				 ITMN_DASHBOARD.ITMNL.ITMNF02_SC1.objlib ) AS objlib, 
		COALESCE(ITMN_DASHBOARD.ITMNL.ITMNF02_DEV.objname , 
				 ITMN_DASHBOARD.ITMNL.ITMNF02_BDC.objname ,
				 ITMN_DASHBOARD.ITMNL.ITMNF02_HD5.objname ,
				 ITMN_DASHBOARD.ITMNL.ITMNF02_JAX.objname ,
				 ITMN_DASHBOARD.ITMNL.ITMNF02_NDC.objname ,
				 ITMN_DASHBOARD.ITMNL.ITMNF02_SC1.objname ) AS objname, 
		COALESCE(ITMN_DASHBOARD.ITMNL.ITMNF02_DEV.objtype , 
				 ITMN_DASHBOARD.ITMNL.ITMNF02_BDC.objtype ,
				 ITMN_DASHBOARD.ITMNL.ITMNF02_HD5.objtype ,
				 ITMN_DASHBOARD.ITMNL.ITMNF02_JAX.objtype ,
				 ITMN_DASHBOARD.ITMNL.ITMNF02_NDC.objtype ,
				 ITMN_DASHBOARD.ITMNL.ITMNF02_SC1.objtype ) AS objtype, 			
	ITMN_DASHBOARD.ITMNL.ITMNF02_DEV.objlib  AS List11,
	ITMN_DASHBOARD.ITMNL.ITMNF02_DEV.objname AS List12,
	ITMN_DASHBOARD.ITMNL.ITMNF02_DEV.objtype AS List13,
	ITMN_DASHBOARD.ITMNL.ITMNF02_BDC.objlib  AS List21,
	ITMN_DASHBOARD.ITMNL.ITMNF02_BDC.objname AS List22,
	ITMN_DASHBOARD.ITMNL.ITMNF02_BDC.objtype AS List23,
	ITMN_DASHBOARD.ITMNL.ITMNF02_HD5.objlib  AS List31,
	ITMN_DASHBOARD.ITMNL.ITMNF02_HD5.objname AS List32,
	ITMN_DASHBOARD.ITMNL.ITMNF02_HD5.objtype AS List33,
	ITMN_DASHBOARD.ITMNL.ITMNF02_JAX.objlib  AS List41,
	ITMN_DASHBOARD.ITMNL.ITMNF02_JAX.objname AS List42,
	ITMN_DASHBOARD.ITMNL.ITMNF02_JAX.objtype AS List43,
	ITMN_DASHBOARD.ITMNL.ITMNF02_NDC.objlib  AS List51,
	ITMN_DASHBOARD.ITMNL.ITMNF02_NDC.objname AS List52,
	ITMN_DASHBOARD.ITMNL.ITMNF02_NDC.objtype AS List53,
	ITMN_DASHBOARD.ITMNL.ITMNF02_SC1.objlib  AS List61,
	ITMN_DASHBOARD.ITMNL.ITMNF02_SC1.objname AS List62,
	ITMN_DASHBOARD.ITMNL.ITMNF02_SC1.objtype AS List63
FROM (SELECT objlib, objname, objtype FROM ITMN_DASHBOARD.ITMNL.ITMNF02_DEV UNION ALL 
      SELECT objlib, objname, objtype FROM ITMN_DASHBOARD.ITMNL.ITMNF02_BDC UNION ALL 
      SELECT objlib, objname, objtype FROM ITMN_DASHBOARD.ITMNL.ITMNF02_HD5 UNION ALL 
      SELECT objlib, objname, objtype FROM ITMN_DASHBOARD.ITMNL.ITMNF02_JAX UNION ALL 
      SELECT objlib, objname, objtype FROM ITMN_DASHBOARD.ITMNL.ITMNF02_NDC UNION ALL 
      SELECT objlib, objname, objtype FROM ITMN_DASHBOARD.ITMNL.ITMNF02_SC1 
      ) AS AK 
      LEFT JOIN ITMN_DASHBOARD.ITMNL.ITMNF02_DEV ON 
      			AK.objlib  = ITMN_DASHBOARD.ITMNL.ITMNF02_DEV.objlib   AND
      			AK.objname = ITMN_DASHBOARD.ITMNL.ITMNF02_DEV.objname  AND 
      			AK.objtype = ITMN_DASHBOARD.ITMNL.ITMNF02_DEV.objtype 
      LEFT JOIN ITMN_DASHBOARD.ITMNL.ITMNF02_BDC ON 
      			AK.objlib  = ITMN_DASHBOARD.ITMNL.ITMNF02_BDC.objlib   AND
      			AK.objname = ITMN_DASHBOARD.ITMNL.ITMNF02_BDC.objname  AND
      			AK.objtype = ITMN_DASHBOARD.ITMNL.ITMNF02_BDC.objtype
      LEFT JOIN ITMN_DASHBOARD.ITMNL.ITMNF02_HD5 ON 
      			AK.objlib  = ITMN_DASHBOARD.ITMNL.ITMNF02_HD5.objlib   AND
      			AK.objname = ITMN_DASHBOARD.ITMNL.ITMNF02_HD5.objname  AND
      			AK.objtype = ITMN_DASHBOARD.ITMNL.ITMNF02_HD5.objtype
      LEFT JOIN ITMN_DASHBOARD.ITMNL.ITMNF02_JAX ON 
      			AK.objlib  = ITMN_DASHBOARD.ITMNL.ITMNF02_JAX.objlib   AND
      			AK.objname = ITMN_DASHBOARD.ITMNL.ITMNF02_JAX.objname  AND 
      			AK.objtype = ITMN_DASHBOARD.ITMNL.ITMNF02_JAX.objtype 
      LEFT JOIN ITMN_DASHBOARD.ITMNL.ITMNF02_NDC ON 
      			AK.objlib  = ITMN_DASHBOARD.ITMNL.ITMNF02_NDC.objlib   AND
      			AK.objname = ITMN_DASHBOARD.ITMNL.ITMNF02_NDC.objname  AND
      			AK.objtype = ITMN_DASHBOARD.ITMNL.ITMNF02_NDC.objtype
      LEFT JOIN ITMN_DASHBOARD.ITMNL.ITMNF02_SC1 ON 
      			AK.objlib  = ITMN_DASHBOARD.ITMNL.ITMNF02_SC1.objlib   AND
      			AK.objname = ITMN_DASHBOARD.ITMNL.ITMNF02_SC1.objname  AND 
      			AK.objtype = ITMN_DASHBOARD.ITMNL.ITMNF02_SC1.objtype 
 ) 
SELECT objlib, objname, objtype, 
		CASE WHEN List11 IS NOT NULL THEN 'Yes' ELSE '-' END AS DEV, 
		CASE WHEN List21 IS NOT NULL THEN 'Yes' ELSE '-' END AS BDC, 
		CASE WHEN List31 IS NOT NULL THEN 'Yes' ELSE '-' END AS HD5,
		CASE WHEN List41 IS NOT NULL THEN 'Yes' ELSE '-' END AS JAX, 
		CASE WHEN List51 IS NOT NULL THEN 'Yes' ELSE '-' END AS NDC, 
		CASE WHEN List61 IS NOT NULL THEN 'Yes' ELSE '-' END AS SC1,
        CASE WHEN List11 IS NOT NULL AND 
                  List21 IS NOT NULL AND 
                  List31 IS NOT NULL AND 
                  List41 IS NOT NULL AND 
                  List51 IS NOT NULL AND 
                  List61 IS NOT NULL THEN 'Okay' ELSE 'Error' 
        END AS Comment 
FROM Combined;


WITH KEYS AS (
SELECT CASE objlib WHEN 'PKTOOL' THEN 'PKTOOL' WHEN 'MRKMAG90' THEN 'MRKMAG90' ELSE CONCAT(SUBSTR(objlib,1,2),'___', SUBSTR(objlib,6)) END AS objlib,objname,objtype
FROM ITMN_DASHBOARD.ITMNL.ITMNF02_BDC)
SELECT objlib, count(*) FROM KEYS GROUP BY objlib ORDER BY 1
; 
SELECT objlib, count(*) FROM ITMN_DASHBOARD.ITMNL.ITMNF02_BDC GROUP BY objlib ORDER BY 1;
----------------------------
WITH 
	F02_BDC AS (
		SELECT CASE WHEN substr(objlib,3,3) = 'GIL' THEN objlib ELSE CONCAT(SUBSTR(objlib,1,2),'___', SUBSTR(objlib,6)) END  objlib, objname,objtype 
		FROM ITMN_DASHBOARD.ITMNL.ITMNF02_BDC WHERE objlib NOT IN ('PKTOOL','MRKMAG90') ),
	F02_HD5 AS (
		SELECT CASE WHEN substr(objlib,3,3) = 'GIL' THEN objlib ELSE CONCAT(SUBSTR(objlib,1,2),'___', SUBSTR(objlib,6)) END  objlib, objname,objtype 
		FROM ITMN_DASHBOARD.ITMNL.ITMNF02_HD5 WHERE objlib NOT IN ('PKTOOL','MRKMAG90') ),
	F02_JAX AS (
		SELECT CASE WHEN substr(objlib,3,3) = 'GIL' THEN objlib ELSE CONCAT(SUBSTR(objlib,1,2),'___', SUBSTR(objlib,6)) END  objlib, objname,objtype 
		FROM ITMN_DASHBOARD.ITMNL.ITMNF02_JAX WHERE objlib NOT IN ('PKTOOL','MRKMAG90') ),
	F02_NDC AS (
		SELECT CASE WHEN substr(objlib,3,3) = 'GIL' THEN objlib ELSE CONCAT(SUBSTR(objlib,1,2),'___', SUBSTR(objlib,6)) END  objlib, objname,objtype 
		FROM ITMN_DASHBOARD.ITMNL.ITMNF02_NDC WHERE objlib NOT IN ('PKTOOL','MRKMAG90') ),
	F02_SC1 AS (
		SELECT CASE WHEN substr(objlib,3,3) = 'GIL' THEN objlib ELSE CONCAT(SUBSTR(objlib,1,2),'___', SUBSTR(objlib,6)) END  objlib, objname,objtype 
		FROM ITMN_DASHBOARD.ITMNL.ITMNF02_SC1 WHERE objlib NOT IN ('PKTOOL','MRKMAG90') ),
	Combined AS ( 
	SELECT 
		COALESCE(F02_BDC.objlib  ,F02_HD5.objlib  ,F02_JAX.objlib  ,F02_NDC.objlib  ,F02_SC1.objlib  ) AS objlib, 
		COALESCE(F02_BDC.objname ,F02_HD5.objname ,F02_JAX.objname ,F02_NDC.objname ,F02_SC1.objname ) AS objname, 
		COALESCE(F02_BDC.objtype ,F02_HD5.objtype ,F02_JAX.objtype ,F02_NDC.objtype ,F02_SC1.objtype ) AS objtype, 			
		F02_BDC.objlib  AS List21,F02_BDC.objname AS List22,F02_BDC.objtype AS List23,
		F02_HD5.objlib  AS List31,F02_HD5.objname AS List32,F02_HD5.objtype AS List33,
		F02_JAX.objlib  AS List41,F02_JAX.objname AS List42,F02_JAX.objtype AS List43,
		F02_NDC.objlib  AS List51,F02_NDC.objname AS List52,F02_NDC.objtype AS List53,
		F02_SC1.objlib  AS List61,F02_SC1.objname AS List62,F02_SC1.objtype AS List63
	FROM (
      SELECT objlib, objname, objtype FROM F02_BDC UNION ALL 
      SELECT objlib, objname, objtype FROM F02_HD5 UNION ALL 
      SELECT objlib, objname, objtype FROM F02_JAX UNION ALL 
      SELECT objlib, objname, objtype FROM F02_NDC UNION ALL 
      SELECT objlib, objname, objtype FROM F02_SC1 
      ) AS AK 
      LEFT JOIN F02_BDC ON 
      			AK.objlib  = F02_BDC.objlib   AND
      			AK.objname = F02_BDC.objname  AND
      			AK.objtype = F02_BDC.objtype
      LEFT JOIN F02_HD5 ON 
      			AK.objlib  = F02_HD5.objlib   AND
      			AK.objname = F02_HD5.objname  AND
      			AK.objtype = F02_HD5.objtype
      LEFT JOIN F02_JAX ON 
      			AK.objlib  = F02_JAX.objlib   AND
      			AK.objname = F02_JAX.objname  AND 
      			AK.objtype = F02_JAX.objtype 
      LEFT JOIN F02_NDC ON 
      			AK.objlib  = F02_NDC.objlib   AND
      			AK.objname = F02_NDC.objname  AND
      			AK.objtype = F02_NDC.objtype
      LEFT JOIN F02_SC1 ON 
      			AK.objlib  = F02_SC1.objlib   AND
      			AK.objname = F02_SC1.objname  AND 
      			AK.objtype = F02_SC1.objtype 
 ), 
 report AS ( 
	SELECT DISTINCT objlib, objname, objtype, 
		CASE WHEN List21 IS NOT NULL THEN 'Yes' ELSE '-' END AS BDC, 
		CASE WHEN List31 IS NOT NULL THEN 'Yes' ELSE '-' END AS HD5,
		CASE WHEN List41 IS NOT NULL THEN 'Yes' ELSE '-' END AS JAX, 
		CASE WHEN List51 IS NOT NULL THEN 'Yes' ELSE '-' END AS NDC, 
		CASE WHEN List61 IS NOT NULL THEN 'Yes' ELSE '-' END AS SC1,
        CASE WHEN 
                  List21 IS NOT NULL AND 
                  List31 IS NOT NULL AND 
                  List41 IS NOT NULL AND 
                  List51 IS NOT NULL AND 
                  List61 IS NOT NULL THEN '' ELSE 'Variance' 
        END AS COMMENT
		FROM Combined)
SELECT * FROM report WHERE COMMENT = 'Variance'		ORDER BY 1, 2, 3 ---
;


USE warehouse
SELECT CASE WHEN substr(objlib,3,3) = 'GIL' THEN objlib ELSE CONCAT(SUBSTR(objlib,1,2),'___', SUBSTR(objlib,6)) END  objlib, objname,objtype 
FROM ITMN_DASHBOARD.ITMNL.ITMNF02_BDC WHERE objlib NOT IN ('PKTOOL','MRKMAG90');

SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF02 WHERE objname='TMSQFSI';
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF01;

----F05
WITH objectsx AS (
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF05_BDC  
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF05_JAX 
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF05_HD5  
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF05_NDC  
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF05_SC1  
UNION ALL
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF05_DEV  
)
SELECT envn, whse, report, time_stamp, count(*) FROM objectsx GROUP BY whse,envn, report, time_stamp ORDER BY 2,3,1 ;
--SELECT envn, whse, report, objlib,time_stamp, count(*) FROM objectsx GROUP BY whse,envn, report,objlib, time_stamp ORDER BY 2,3,1 ;
;

SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF03_DEV;
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF05_NDC ORDER BY ln;

---Top 20
SELECT t20.whse, t20.datep, t20.ROW_NUMBER, t20.ln, t20.object_count, t20.library_size
FROM (
     SELECT whse,LN, date(time_stamp) AS datep, object_count, library_size, ROW_NUMBER() OVER(ORDER BY library_size DESC) as row_number
     FROM ITMN_DASHBOARD.ITMNL.ITMNF05_HD5 
      ) t20
WHERE t20.row_number <= 20 
;
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF05_HD5;
SELECT count(*),sum(library_size) FROM ITMN_DASHBOARD.ITMNL.ITMNF05_HD5;
SELECT * FROM QSYS2.SYSPARTITIONSTAT A WHERE SYSTEM_TABLE_SCHEMA in ('JOURNAL') ;

----top 20
WITH CustomerSales AS (
    SELECT
        whse, 
        iasp_name,
		date(time_stamp) AS time_stamp,
		ln,
        object_count, 
		to_decimal(library_size/1000000000,9,2) AS library_size 
    FROM ITMN_DASHBOARD.ITMNL.ITMNF05_HD5
),
RankedCustomers AS (
    SELECT
        whse, 
        iasp_name,
		time_stamp,
		ln,
        object_count, 
		library_size,
        ROW_NUMBER() OVER (ORDER BY library_size DESC) AS LibRank
    FROM
        CustomerSales
),
Top20Customers AS (
    SELECT
        whse, 
        iasp_name,
		time_stamp,
		ln,
        object_count, 
		library_size,
		LibRank
    FROM
        RankedCustomers
    WHERE
        LibRank <= 20
),
OtherCustomers AS (
    SELECT
        whse, 
        iasp_name,
		time_stamp,
		'Rest of Libraries: '||to_char(count(*)) as ln,
        sum(object_count) AS object_count, 
		sum(library_size) AS library_size,
        0 as LibRank
    FROM
        RankedCustomers
    WHERE
        LibRank > 20
	Group BY whse, iasp_name,time_stamp
),
TotalSales2024 AS (
select  whse, 
		iasp_name,
		time_stamp,
		'Total ' as ln,
        sum(object_count) AS object_count, 
		sum(library_size) AS library_size,
		0 as LibRank
    FROM CustomerSales
  	Group BY whse, iasp_name,time_stamp
)
SELECT a.*,
	CASE
        WHEN (SELECT library_size FROM TotalSales2024) = 0 THEN 0  -- Avoid division by zero
        ELSE (library_size * 100.0 / (SELECT library_size FROM TotalSales2024))
    END AS PercentageOfTotalSales
    FROM  Top20Customers a 
UNION ALL
SELECT b.* ,
	CASE
        WHEN (SELECT library_size FROM OtherCustomers) = 0 THEN 0  -- Avoid division by zero
        ELSE (library_size * 100.0 / (SELECT library_size FROM TotalSales2024))
    END AS PercentageOfTotalSales
	FROM  OtherCustomers b
UNION ALL
SELECT c.* ,
	CASE
        WHEN (SELECT library_size FROM TotalSales2024) = 0 THEN 0  -- Avoid division by zero
        ELSE 100.0 
    END AS PercentageOfTotalSales
	FROM  TotalSales2024 c
;


---top 20speed
CREATE OR REPLACE VIEW ITMN_DASHBOARD.ITMNL.ITMNF05_HD5A AS
(
WITH LibraryInfos AS (
    SELECT
        whse, 
        iasp_name,
		date(time_stamp) AS time_stamp,
		ln,
        object_count, 
		to_decimal(library_size/1000000000,9,2) AS library_size 
    FROM ITMN_DASHBOARD.ITMNL.ITMNF05_HD5
),
RankedLibraries AS (
    SELECT
        whse, 
        iasp_name,
		time_stamp,
        ROW_NUMBER() OVER (ORDER BY library_size DESC) AS LibRank,
		ln,
        object_count, 
		library_size
    FROM
        LibraryInfos
),
Top20Libraries AS (
    SELECT
        whse, 
        iasp_name,
		time_stamp,
		LibRank,
		ln,
        object_count, 
		library_size
    FROM
        RankedLibraries
    WHERE
        LibRank <= 20
),
OtherLibraries AS (
    SELECT
        whse, 
        iasp_name,
		time_stamp,
        0 as LibRank,
		'Other : '||to_char(count(*))||' libraries' as ln,
        sum(object_count) AS object_count, 
		sum(library_size) AS library_size
    FROM
        RankedLibraries
    WHERE
        LibRank > 20
	Group BY whse, iasp_name,time_stamp
),
TotalLibraries AS (
select  whse, 
		iasp_name,
		time_stamp,
		0 as LibRank,
		'Total ' as ln,
        sum(object_count) AS object_count, 
		sum(library_size) AS library_size
    FROM LibraryInfos
  	Group BY whse, iasp_name,time_stamp
)
SELECT a.*,
	CASE
        WHEN (SELECT library_size FROM TotalLibraries) = 0 THEN 0  
        ELSE (library_size/(SELECT library_size FROM TotalLibraries))
    END AS PercentageOfTotalSales
    FROM  Top20Libraries a 
UNION ALL
SELECT b.* ,
	CASE
        WHEN (SELECT library_size FROM OtherLibraries) = 0 THEN 0  
        ELSE (library_size/(SELECT library_size FROM TotalLibraries))
    END AS PercentageOfTotalSales
	FROM  OtherLibraries b
UNION ALL
SELECT c.* ,
	CASE
        WHEN (SELECT library_size FROM TotalLibraries) = 0 THEN 0  
        ELSE 1
    END AS PercentageOfTotalSales
	FROM  TotalLibraries c
)
;
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF05_DEVA;

---top 20speed view
CREATE OR REPLACE VIEW ITMN_DASHBOARD.ITMNL.ITMNF05_SC1A AS
(
WITH LibraryInfos AS (
    SELECT
        whse, 
        iasp_name,
		date(time_stamp) AS time_stamp,
		ln,
        object_count, 
		to_decimal(library_size/1000000000,9,2) AS library_size 
    FROM ITMN_DASHBOARD.ITMNL.ITMNF05_SC1
),
RankedLibraries AS (
    SELECT
        whse, 
        iasp_name,
		time_stamp,
        ROW_NUMBER() OVER (ORDER BY library_size DESC) AS LibRank,
		ln,
        object_count, 
		library_size
    FROM
        LibraryInfos
),
Top20Libraries AS (
    SELECT
        whse, 
        iasp_name,
		time_stamp,
		LibRank,
		ln,
        object_count, 
		library_size
    FROM
        RankedLibraries
    WHERE
        LibRank <= 20
),
OtherLibraries AS (
    SELECT
        whse, 
        iasp_name,
		time_stamp,
        21 as LibRank,
		'Other : '||to_char(count(*))||' libraries' as ln,
        sum(object_count) AS object_count, 
		sum(library_size) AS library_size
    FROM
        RankedLibraries
    WHERE
        LibRank > 20
	Group BY whse, iasp_name,time_stamp
),
TotalLibraries AS (
select  whse, 
		iasp_name,
		time_stamp,
		0 as LibRank,
		'Total ' as ln,
        sum(object_count) AS object_count, 
		sum(library_size) AS library_size
    FROM LibraryInfos
  	Group BY whse, iasp_name,time_stamp
)
SELECT a.*,
	CASE
        WHEN (SELECT library_size FROM TotalLibraries) = 0 THEN 0  
        ELSE (library_size/(SELECT library_size FROM TotalLibraries))
    END AS PercentageOfTotalSales
    FROM  Top20Libraries a 
UNION ALL
SELECT b.* ,
	CASE
        WHEN (SELECT library_size FROM OtherLibraries) = 0 THEN 0  
        ELSE (library_size/(SELECT library_size FROM TotalLibraries))
    END AS PercentageOfTotalSales
	FROM  OtherLibraries b
--UNION ALL
--SELECT c.* ,
--	CASE
--        WHEN (SELECT library_size FROM TotalLibraries) = 0 THEN 0  
--        ELSE 1
--    END AS PercentageOfTotalSales
--	FROM  TotalLibraries c
)

----------------------------------
----------------------------------
---top speed view
SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF01 ;
---top speed view
CREATE OR REPLACE VIEW ITMN_DASHBOARD.ITMNL.ITMNF05_SC1A AS
(
WITH LibraryInfos AS (
    SELECT
        whse, 
        iasp_name,
		date(time_stamp) AS Extraction_Date,
		ln as Library,
        object_count, 
		to_decimal(Library_size/1000000000,9,2) AS Library_size 
    FROM ITMN_DASHBOARD.ITMNL.ITMNF05_SC1
),
RankedLibraries AS (
    SELECT
        whse, 
        iasp_name,
		Extraction_Date,
        ROW_NUMBER() OVER (ORDER BY Library_size DESC) AS Rank,
		Library,
        object_count, 
		Library_size
    FROM
        LibraryInfos
),
TopLibraries AS (
    SELECT
        whse, 
        iasp_name,
		Extraction_Date,
		Rank,
		Library,
        object_count, 
		Library_size
    FROM
        RankedLibraries
    WHERE
        Rank <= 15
),
OtherLibraries AS (
    SELECT
        whse, 
        iasp_name,
		Extraction_Date,
        16 as Rank,
		'Other : '||to_char(count(*))||' libraries' as Library,
        sum(object_count) AS object_count, 
		sum(Library_size) AS Library_size
    FROM
        RankedLibraries
    WHERE
        Rank > 15
	Group BY whse, iasp_name,Extraction_Date
),
TotalLibraries AS (
select  whse, 
		iasp_name,
		Extraction_Date,
		0 as Rank,
		'Total ' as Library,
        sum(object_count) AS object_count, 
		sum(Library_size) AS Library_size
    FROM LibraryInfos
  	Group BY whse, iasp_name,Extraction_Date
)
SELECT a.*,
	CASE
        WHEN (SELECT Library_size FROM TotalLibraries) = 0 THEN 0  
        ELSE (Library_size/(SELECT Library_size FROM TotalLibraries))
    END AS Percentage
    FROM  TopLibraries a 
UNION ALL
SELECT b.* ,
	CASE
        WHEN (SELECT Library_size FROM OtherLibraries) = 0 THEN 0  
        ELSE (Library_size/(SELECT Library_size FROM TotalLibraries))
    END AS Percentage
	FROM  OtherLibraries b
--UNION ALL
--SELECT c.* ,
--	CASE
--        WHEN (SELECT Library_size FROM TotalLibraries) = 0 THEN 0  
--        ELSE 1
--    END AS Percentage
--	FROM  TotalLibraries c
)
;
SELECT * FROM ITMN_DASHBOARD.ITMNL.hvr_ibitmon_dev_snow_itmn;


SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF03_DEV a ;

---files in wm libraries
CREATE OR REPLACE VIEW ITMN_DASHBOARD.ITMNL.ITMNF03A AS
(
SELECT a.*,b.* FROM ITMN_DASHBOARD.ITMNL.ITMNF03_BDC a INNER JOIN ITMN_DASHBOARD.ITMNL.ITMNF04_BDC b ON 
a.whse=b.whse AND a.envn=b.envn AND a.SYSTEM_TABLE_SCHEMA = b.SYSTEM_TABLE_SCHEMA AND a.system_table_name = b.SYSTEM_TABLE_NAME  
UNION ALL
SELECT a.*,b.* FROM ITMN_DASHBOARD.ITMNL.ITMNF03_JAX a INNER JOIN ITMN_DASHBOARD.ITMNL.ITMNF04_JAX b ON 
a.whse=b.whse AND a.envn=b.envn AND a.SYSTEM_TABLE_SCHEMA = b.SYSTEM_TABLE_SCHEMA AND a.system_table_name = b.SYSTEM_TABLE_NAME  
UNION ALL
SELECT a.*,b.* FROM ITMN_DASHBOARD.ITMNL.ITMNF03_HD5 a INNER JOIN ITMN_DASHBOARD.ITMNL.ITMNF04_HD5 b ON 
a.whse=b.whse AND a.envn=b.envn AND a.SYSTEM_TABLE_SCHEMA = b.SYSTEM_TABLE_SCHEMA AND a.system_table_name = b.SYSTEM_TABLE_NAME  
UNION ALL
SELECT a.*,b.* FROM ITMN_DASHBOARD.ITMNL.ITMNF03_NDC a INNER JOIN ITMN_DASHBOARD.ITMNL.ITMNF04_NDC b ON 
a.whse=b.whse AND a.envn=b.envn AND a.SYSTEM_TABLE_SCHEMA = b.SYSTEM_TABLE_SCHEMA AND a.system_table_name = b.SYSTEM_TABLE_NAME  
UNION ALL
SELECT a.*,b.* FROM ITMN_DASHBOARD.ITMNL.ITMNF03_SC1 a INNER JOIN ITMN_DASHBOARD.ITMNL.ITMNF04_SC1 b ON 
a.whse=b.whse AND a.envn=b.envn AND a.SYSTEM_TABLE_SCHEMA = b.SYSTEM_TABLE_SCHEMA AND a.system_table_name = b.SYSTEM_TABLE_NAME  
UNION ALL
SELECT a.*,b.* FROM ITMN_DASHBOARD.ITMNL.ITMNF03_DEV a INNER JOIN ITMN_DASHBOARD.ITMNL.ITMNF04_DEV b ON 
a.whse=b.whse AND a.envn=b.envn AND a.SYSTEM_TABLE_SCHEMA = b.SYSTEM_TABLE_SCHEMA AND a.system_table_name = b.SYSTEM_TABLE_NAME  
);

---files in wm libraries
CREATE OR REPLACE VIEW ITMN_DASHBOARD.ITMNL.ITMNF03A AS (
SELECT a.*,b.whse AS w FROM ITMN_DASHBOARD.ITMNL.ITMNF03_BDC a INNER JOIN ITMN_DASHBOARD.ITMNL.ITMNF04_BDC b ON 
a.whse=b.whse AND a.envn=b.envn AND a.SYSTEM_TABLE_SCHEMA = b.SYSTEM_TABLE_SCHEMA AND a.system_table_name = b.SYSTEM_TABLE_NAME  
UNION ALL
SELECT a.*,b.whse AS w FROM ITMN_DASHBOARD.ITMNL.ITMNF03_JAX a INNER JOIN ITMN_DASHBOARD.ITMNL.ITMNF04_JAX b ON 
a.whse=b.whse AND a.envn=b.envn AND a.SYSTEM_TABLE_SCHEMA = b.SYSTEM_TABLE_SCHEMA AND a.system_table_name = b.SYSTEM_TABLE_NAME  
UNION ALL
SELECT a.*,b.whse AS w FROM ITMN_DASHBOARD.ITMNL.ITMNF03_HD5 a INNER JOIN ITMN_DASHBOARD.ITMNL.ITMNF04_HD5 b ON 
a.whse=b.whse AND a.envn=b.envn AND a.SYSTEM_TABLE_SCHEMA = b.SYSTEM_TABLE_SCHEMA AND a.system_table_name = b.SYSTEM_TABLE_NAME  
UNION ALL
SELECT a.*,b.whse AS w FROM ITMN_DASHBOARD.ITMNL.ITMNF03_NDC a INNER JOIN ITMN_DASHBOARD.ITMNL.ITMNF04_NDC b ON 
a.whse=b.whse AND a.envn=b.envn AND a.SYSTEM_TABLE_SCHEMA = b.SYSTEM_TABLE_SCHEMA AND a.system_table_name = b.SYSTEM_TABLE_NAME  
UNION ALL
SELECT a.*,b.whse AS w FROM ITMN_DASHBOARD.ITMNL.ITMNF03_SC1 a INNER JOIN ITMN_DASHBOARD.ITMNL.ITMNF04_SC1 b ON 
a.whse=b.whse AND a.envn=b.envn AND a.SYSTEM_TABLE_SCHEMA = b.SYSTEM_TABLE_SCHEMA AND a.system_table_name = b.SYSTEM_TABLE_NAME  
UNION ALL
SELECT a.*,b.whse AS w FROM ITMN_DASHBOARD.ITMNL.ITMNF03_DEV a INNER JOIN ITMN_DASHBOARD.ITMNL.ITMNF04_DEV b ON 
a.whse=b.whse AND a.envn=b.envn AND a.SYSTEM_TABLE_SCHEMA = b.SYSTEM_TABLE_SCHEMA AND a.system_table_name = b.SYSTEM_TABLE_NAME  
);

SELECT * FROM  ITMN_DASHBOARD.ITMNL.ITMNF03 WHERE SYSTEM_TABLE_NAME= 'PXSTYL00' ORDER BY 2,1;
SELECT * FROM  ITMN_DASHBOARD.ITMNL.ITMNF03  WHERE SYSTEM_TABLE_NAME= 'IPPARM00' ORDER BY 2,1;
SELECT * FROM  ITMN_DASHBOARD.ITMNL.ITMNF05_BDCA  ;

SELECT mlast_change_timestamp,last_altered_timestamp, whse, envn, SYSTEM_TABLE_SCHEMA,SYSTEM_TABLE_NAME,msystem_table_member,TEXT_DESCRIPTION,NATIVE_TYPE,file_type,NUMBER_MEMBERS ,FILE_OWNER,NUMBER_MEMBERS,MAXIMUM_RECORD_LENGTH,ALLOW_DELETE,FORMAT_LEVEL_ID,RECORD_LENGTH,mnumber_rows,
mnumber_deleted_rows, mdata_size,mlast_change_timestamp,mdays_used_count, a.* FROM ITMN_DASHBOARD.ITMNL.ITMNF03A a
WHERE SYSTEM_TABLE_NAME= 'ATTRIB90' AND envn='PD'  ORDER BY 1 desc;
SELECT whse,envn,native_type, file_type, count(*) FROM ITMN_DASHBOARD.ITMNL.ITMNF03 GROUP BY whse, envn,NATIVE_TYPE, FILE_TYPE ORDER BY 1,2,3,4;

SELECT * FROM ITMN_DASHBOARD.ITMNL.ITMNF03 WHERE NUMBER_MEMBERS =1 AND envn='PD';

---------------------CRIA F03a
CREATE OR REPLACE VIEW ITMN_DASHBOARD.ITMNL.ITMNF03A AS (
SELECT a.*,
    b.WHSE mWHSE,	b.ENVN mENVN,	b.REPORT mREPORT,	b.TIME_STAMP mTIME_STAMP,	b.TABLE_SCHEMA mTABLE_SCHEMA,	b.TABLE_NAME mTABLE_NAME,
	b.TABLE_PARTITION mTABLE_PARTITION,	b.PARTITION_TYPE mPARTITION_TYPE,	b.PARTITION_NUMBER mPARTITION_NUMBER,	b.NUMBER_DISTRIBUTED_PARTITIONS mNUMBER_DISTRIBUTED_PARTITIONS,
	b.NUMBER_ROWS mNUMBER_ROWS,	b.NUMBER_ROW_PAGES mNUMBER_ROW_PAGES,	b.NUMBER_PAGES mNUMBER_PAGES,	b.OVERFLOW mOVERFLOW,	b.CLUSTERED mCLUSTERED,
	b.ACTIVE_BLOCKS mACTIVE_BLOCKS,	b.AVGCOMPRESSEDROWSIZE mAVGCOMPRESSEDROWSIZE,	b.AVGROWCOMPRESSIONRATIO mAVGROWCOMPRESSIONRATIO,	b.AVGROWSIZE mAVGROWSIZE,
	b.PCTROWSCOMPRESSED mPCTROWSCOMPRESSED,	b.PCTPAGESSAVED mPCTPAGESSAVED,	b.NUMBER_DELETED_ROWS mNUMBER_DELETED_ROWS,	b.DATA_SIZE mDATA_SIZE,
	b.VARIABLE_LENGTH_SIZE mVARIABLE_LENGTH_SIZE,	b.VARIABLE_LENGTH_SEGMENTS mVARIABLE_LENGTH_SEGMENTS,	b.FIXED_LENGTH_EXTENTS mFIXED_LENGTH_EXTENTS,
	b.VARIABLE_LENGTH_EXTENTS mVARIABLE_LENGTH_EXTENTS,	b.COLUMN_STATS_SIZE mCOLUMN_STATS_SIZE,	b.MAINTAINED_TEMPORARY_INDEX_SIZE mMAINTAINED_TEMPORARY_INDEX_SIZE,
	b.NUMBER_DISTINCT_INDEXES mNUMBER_DISTINCT_INDEXES,	b.OPEN_OPERATIONS mOPEN_OPERATIONS,	b.CLOSE_OPERATIONS mCLOSE_OPERATIONS,	b.INSERT_OPERATIONS mINSERT_OPERATIONS,
	b.BLOCKED_INSERT_OPERATIONS mBLOCKED_INSERT_OPERATIONS,	b.BLOCKED_INSERT_ROWS mBLOCKED_INSERT_ROWS,	b.UPDATE_OPERATIONS mUPDATE_OPERATIONS,	b.DELETE_OPERATIONS mDELETE_OPERATIONS,
	b.CLEAR_OPERATIONS mCLEAR_OPERATIONS,	b.COPY_OPERATIONS mCOPY_OPERATIONS,	b.REORGANIZE_OPERATIONS mREORGANIZE_OPERATIONS,	b.INDEX_BUILDS mINDEX_BUILDS,	b.LOGICAL_READS mLOGICAL_READS,
	b.PHYSICAL_READS mPHYSICAL_READS,	b.SEQUENTIAL_READS mSEQUENTIAL_READS,	b.RANDOM_READS mRANDOM_READS,	b.CREATE_TIMESTAMP mCREATE_TIMESTAMP,	b.LAST_CHANGE_TIMESTAMP mLAST_CHANGE_TIMESTAMP,
	b.LAST_SAVE_TIMESTAMP mLAST_SAVE_TIMESTAMP,	b.LAST_RESTORE_TIMESTAMP mLAST_RESTORE_TIMESTAMP,	b.LAST_USED_TIMESTAMP mLAST_USED_TIMESTAMP,	b.DAYS_USED_COUNT mDAYS_USED_COUNT,
	b.LAST_RESET_TIMESTAMP mLAST_RESET_TIMESTAMP,	b.NEXT_IDENTITY_VALUE mNEXT_IDENTITY_VALUE,	b.LOWINCLUSIVE mLOWINCLUSIVE,	b.LOWVALUE mLOWVALUE,	b.HIGHINCLUSIVE mHIGHINCLUSIVE,
	b.HIGHVALUE mHIGHVALUE,	b.NUMBER_PARTITIONING_KEYS mNUMBER_PARTITIONING_KEYS,	b.PARTITIONING_KEYS mPARTITIONING_KEYS,	b.KEEP_IN_MEMORY mKEEP_IN_MEMORY,
	b.MEDIA_PREFERENCE mMEDIA_PREFERENCE,	b.LAST_SOURCE_UPDATE_TIMESTAMP mLAST_SOURCE_UPDATE_TIMESTAMP,	b.SOURCE_TYPE mSOURCE_TYPE,	b.VOLATILE mVOLATILE,	b.PARTITION_TEXT mPARTITION_TEXT,
	b.PARTIAL_TRANSACTION mPARTIAL_TRANSACTION,	b.APPLY_STARTING_RECEIVER_LIBRARY mAPPLY_STARTING_RECEIVER_LIBRARY,	b.APPLY_STARTING_RECEIVER mAPPLY_STARTING_RECEIVER,	b.SYSTEM_TABLE_SCHEMA mSYSTEM_TABLE_SCHEMA,
	b.SYSTEM_TABLE_NAME mSYSTEM_TABLE_NAME,	b.SYSTEM_TABLE_MEMBER mSYSTEM_TABLE_MEMBER
FROM ITMN_DASHBOARD.ITMNL.ITMNF03_BDC a INNER JOIN ITMN_DASHBOARD.ITMNL.ITMNF04_BDC b ON 
a.whse=b.whse AND a.envn=b.envn AND a.SYSTEM_TABLE_SCHEMA = b.SYSTEM_TABLE_SCHEMA AND a.system_table_name = b.SYSTEM_TABLE_NAME  
UNION ALL
SELECT a.*,
    b.WHSE mWHSE,	b.ENVN mENVN,	b.REPORT mREPORT,	b.TIME_STAMP mTIME_STAMP,	b.TABLE_SCHEMA mTABLE_SCHEMA,	b.TABLE_NAME mTABLE_NAME,
	b.TABLE_PARTITION mTABLE_PARTITION,	b.PARTITION_TYPE mPARTITION_TYPE,	b.PARTITION_NUMBER mPARTITION_NUMBER,	b.NUMBER_DISTRIBUTED_PARTITIONS mNUMBER_DISTRIBUTED_PARTITIONS,
	b.NUMBER_ROWS mNUMBER_ROWS,	b.NUMBER_ROW_PAGES mNUMBER_ROW_PAGES,	b.NUMBER_PAGES mNUMBER_PAGES,	b.OVERFLOW mOVERFLOW,	b.CLUSTERED mCLUSTERED,
	b.ACTIVE_BLOCKS mACTIVE_BLOCKS,	b.AVGCOMPRESSEDROWSIZE mAVGCOMPRESSEDROWSIZE,	b.AVGROWCOMPRESSIONRATIO mAVGROWCOMPRESSIONRATIO,	b.AVGROWSIZE mAVGROWSIZE,
	b.PCTROWSCOMPRESSED mPCTROWSCOMPRESSED,	b.PCTPAGESSAVED mPCTPAGESSAVED,	b.NUMBER_DELETED_ROWS mNUMBER_DELETED_ROWS,	b.DATA_SIZE mDATA_SIZE,
	b.VARIABLE_LENGTH_SIZE mVARIABLE_LENGTH_SIZE,	b.VARIABLE_LENGTH_SEGMENTS mVARIABLE_LENGTH_SEGMENTS,	b.FIXED_LENGTH_EXTENTS mFIXED_LENGTH_EXTENTS,
	b.VARIABLE_LENGTH_EXTENTS mVARIABLE_LENGTH_EXTENTS,	b.COLUMN_STATS_SIZE mCOLUMN_STATS_SIZE,	b.MAINTAINED_TEMPORARY_INDEX_SIZE mMAINTAINED_TEMPORARY_INDEX_SIZE,
	b.NUMBER_DISTINCT_INDEXES mNUMBER_DISTINCT_INDEXES,	b.OPEN_OPERATIONS mOPEN_OPERATIONS,	b.CLOSE_OPERATIONS mCLOSE_OPERATIONS,	b.INSERT_OPERATIONS mINSERT_OPERATIONS,
	b.BLOCKED_INSERT_OPERATIONS mBLOCKED_INSERT_OPERATIONS,	b.BLOCKED_INSERT_ROWS mBLOCKED_INSERT_ROWS,	b.UPDATE_OPERATIONS mUPDATE_OPERATIONS,	b.DELETE_OPERATIONS mDELETE_OPERATIONS,
	b.CLEAR_OPERATIONS mCLEAR_OPERATIONS,	b.COPY_OPERATIONS mCOPY_OPERATIONS,	b.REORGANIZE_OPERATIONS mREORGANIZE_OPERATIONS,	b.INDEX_BUILDS mINDEX_BUILDS,	b.LOGICAL_READS mLOGICAL_READS,
	b.PHYSICAL_READS mPHYSICAL_READS,	b.SEQUENTIAL_READS mSEQUENTIAL_READS,	b.RANDOM_READS mRANDOM_READS,	b.CREATE_TIMESTAMP mCREATE_TIMESTAMP,	b.LAST_CHANGE_TIMESTAMP mLAST_CHANGE_TIMESTAMP,
	b.LAST_SAVE_TIMESTAMP mLAST_SAVE_TIMESTAMP,	b.LAST_RESTORE_TIMESTAMP mLAST_RESTORE_TIMESTAMP,	b.LAST_USED_TIMESTAMP mLAST_USED_TIMESTAMP,	b.DAYS_USED_COUNT mDAYS_USED_COUNT,
	b.LAST_RESET_TIMESTAMP mLAST_RESET_TIMESTAMP,	b.NEXT_IDENTITY_VALUE mNEXT_IDENTITY_VALUE,	b.LOWINCLUSIVE mLOWINCLUSIVE,	b.LOWVALUE mLOWVALUE,	b.HIGHINCLUSIVE mHIGHINCLUSIVE,
	b.HIGHVALUE mHIGHVALUE,	b.NUMBER_PARTITIONING_KEYS mNUMBER_PARTITIONING_KEYS,	b.PARTITIONING_KEYS mPARTITIONING_KEYS,	b.KEEP_IN_MEMORY mKEEP_IN_MEMORY,
	b.MEDIA_PREFERENCE mMEDIA_PREFERENCE,	b.LAST_SOURCE_UPDATE_TIMESTAMP mLAST_SOURCE_UPDATE_TIMESTAMP,	b.SOURCE_TYPE mSOURCE_TYPE,	b.VOLATILE mVOLATILE,	b.PARTITION_TEXT mPARTITION_TEXT,
	b.PARTIAL_TRANSACTION mPARTIAL_TRANSACTION,	b.APPLY_STARTING_RECEIVER_LIBRARY mAPPLY_STARTING_RECEIVER_LIBRARY,	b.APPLY_STARTING_RECEIVER mAPPLY_STARTING_RECEIVER,	b.SYSTEM_TABLE_SCHEMA mSYSTEM_TABLE_SCHEMA,
	b.SYSTEM_TABLE_NAME mSYSTEM_TABLE_NAME,	b.SYSTEM_TABLE_MEMBER mSYSTEM_TABLE_MEMBER
FROM ITMN_DASHBOARD.ITMNL.ITMNF03_JAX a INNER JOIN ITMN_DASHBOARD.ITMNL.ITMNF04_JAX b ON 
a.whse=b.whse AND a.envn=b.envn AND a.SYSTEM_TABLE_SCHEMA = b.SYSTEM_TABLE_SCHEMA AND a.system_table_name = b.SYSTEM_TABLE_NAME  
UNION ALL
SELECT a.*,
    b.WHSE mWHSE,	b.ENVN mENVN,	b.REPORT mREPORT,	b.TIME_STAMP mTIME_STAMP,	b.TABLE_SCHEMA mTABLE_SCHEMA,	b.TABLE_NAME mTABLE_NAME,
	b.TABLE_PARTITION mTABLE_PARTITION,	b.PARTITION_TYPE mPARTITION_TYPE,	b.PARTITION_NUMBER mPARTITION_NUMBER,	b.NUMBER_DISTRIBUTED_PARTITIONS mNUMBER_DISTRIBUTED_PARTITIONS,
	b.NUMBER_ROWS mNUMBER_ROWS,	b.NUMBER_ROW_PAGES mNUMBER_ROW_PAGES,	b.NUMBER_PAGES mNUMBER_PAGES,	b.OVERFLOW mOVERFLOW,	b.CLUSTERED mCLUSTERED,
	b.ACTIVE_BLOCKS mACTIVE_BLOCKS,	b.AVGCOMPRESSEDROWSIZE mAVGCOMPRESSEDROWSIZE,	b.AVGROWCOMPRESSIONRATIO mAVGROWCOMPRESSIONRATIO,	b.AVGROWSIZE mAVGROWSIZE,
	b.PCTROWSCOMPRESSED mPCTROWSCOMPRESSED,	b.PCTPAGESSAVED mPCTPAGESSAVED,	b.NUMBER_DELETED_ROWS mNUMBER_DELETED_ROWS,	b.DATA_SIZE mDATA_SIZE,
	b.VARIABLE_LENGTH_SIZE mVARIABLE_LENGTH_SIZE,	b.VARIABLE_LENGTH_SEGMENTS mVARIABLE_LENGTH_SEGMENTS,	b.FIXED_LENGTH_EXTENTS mFIXED_LENGTH_EXTENTS,
	b.VARIABLE_LENGTH_EXTENTS mVARIABLE_LENGTH_EXTENTS,	b.COLUMN_STATS_SIZE mCOLUMN_STATS_SIZE,	b.MAINTAINED_TEMPORARY_INDEX_SIZE mMAINTAINED_TEMPORARY_INDEX_SIZE,
	b.NUMBER_DISTINCT_INDEXES mNUMBER_DISTINCT_INDEXES,	b.OPEN_OPERATIONS mOPEN_OPERATIONS,	b.CLOSE_OPERATIONS mCLOSE_OPERATIONS,	b.INSERT_OPERATIONS mINSERT_OPERATIONS,
	b.BLOCKED_INSERT_OPERATIONS mBLOCKED_INSERT_OPERATIONS,	b.BLOCKED_INSERT_ROWS mBLOCKED_INSERT_ROWS,	b.UPDATE_OPERATIONS mUPDATE_OPERATIONS,	b.DELETE_OPERATIONS mDELETE_OPERATIONS,
	b.CLEAR_OPERATIONS mCLEAR_OPERATIONS,	b.COPY_OPERATIONS mCOPY_OPERATIONS,	b.REORGANIZE_OPERATIONS mREORGANIZE_OPERATIONS,	b.INDEX_BUILDS mINDEX_BUILDS,	b.LOGICAL_READS mLOGICAL_READS,
	b.PHYSICAL_READS mPHYSICAL_READS,	b.SEQUENTIAL_READS mSEQUENTIAL_READS,	b.RANDOM_READS mRANDOM_READS,	b.CREATE_TIMESTAMP mCREATE_TIMESTAMP,	b.LAST_CHANGE_TIMESTAMP mLAST_CHANGE_TIMESTAMP,
	b.LAST_SAVE_TIMESTAMP mLAST_SAVE_TIMESTAMP,	b.LAST_RESTORE_TIMESTAMP mLAST_RESTORE_TIMESTAMP,	b.LAST_USED_TIMESTAMP mLAST_USED_TIMESTAMP,	b.DAYS_USED_COUNT mDAYS_USED_COUNT,
	b.LAST_RESET_TIMESTAMP mLAST_RESET_TIMESTAMP,	b.NEXT_IDENTITY_VALUE mNEXT_IDENTITY_VALUE,	b.LOWINCLUSIVE mLOWINCLUSIVE,	b.LOWVALUE mLOWVALUE,	b.HIGHINCLUSIVE mHIGHINCLUSIVE,
	b.HIGHVALUE mHIGHVALUE,	b.NUMBER_PARTITIONING_KEYS mNUMBER_PARTITIONING_KEYS,	b.PARTITIONING_KEYS mPARTITIONING_KEYS,	b.KEEP_IN_MEMORY mKEEP_IN_MEMORY,
	b.MEDIA_PREFERENCE mMEDIA_PREFERENCE,	b.LAST_SOURCE_UPDATE_TIMESTAMP mLAST_SOURCE_UPDATE_TIMESTAMP,	b.SOURCE_TYPE mSOURCE_TYPE,	b.VOLATILE mVOLATILE,	b.PARTITION_TEXT mPARTITION_TEXT,
	b.PARTIAL_TRANSACTION mPARTIAL_TRANSACTION,	b.APPLY_STARTING_RECEIVER_LIBRARY mAPPLY_STARTING_RECEIVER_LIBRARY,	b.APPLY_STARTING_RECEIVER mAPPLY_STARTING_RECEIVER,	b.SYSTEM_TABLE_SCHEMA mSYSTEM_TABLE_SCHEMA,
	b.SYSTEM_TABLE_NAME mSYSTEM_TABLE_NAME,	b.SYSTEM_TABLE_MEMBER mSYSTEM_TABLE_MEMBER
FROM ITMN_DASHBOARD.ITMNL.ITMNF03_HD5 a INNER JOIN ITMN_DASHBOARD.ITMNL.ITMNF04_HD5 b ON 
a.whse=b.whse AND a.envn=b.envn AND a.SYSTEM_TABLE_SCHEMA = b.SYSTEM_TABLE_SCHEMA AND a.system_table_name = b.SYSTEM_TABLE_NAME  
UNION ALL
SELECT a.*,
    b.WHSE mWHSE,	b.ENVN mENVN,	b.REPORT mREPORT,	b.TIME_STAMP mTIME_STAMP,	b.TABLE_SCHEMA mTABLE_SCHEMA,	b.TABLE_NAME mTABLE_NAME,
	b.TABLE_PARTITION mTABLE_PARTITION,	b.PARTITION_TYPE mPARTITION_TYPE,	b.PARTITION_NUMBER mPARTITION_NUMBER,	b.NUMBER_DISTRIBUTED_PARTITIONS mNUMBER_DISTRIBUTED_PARTITIONS,
	b.NUMBER_ROWS mNUMBER_ROWS,	b.NUMBER_ROW_PAGES mNUMBER_ROW_PAGES,	b.NUMBER_PAGES mNUMBER_PAGES,	b.OVERFLOW mOVERFLOW,	b.CLUSTERED mCLUSTERED,
	b.ACTIVE_BLOCKS mACTIVE_BLOCKS,	b.AVGCOMPRESSEDROWSIZE mAVGCOMPRESSEDROWSIZE,	b.AVGROWCOMPRESSIONRATIO mAVGROWCOMPRESSIONRATIO,	b.AVGROWSIZE mAVGROWSIZE,
	b.PCTROWSCOMPRESSED mPCTROWSCOMPRESSED,	b.PCTPAGESSAVED mPCTPAGESSAVED,	b.NUMBER_DELETED_ROWS mNUMBER_DELETED_ROWS,	b.DATA_SIZE mDATA_SIZE,
	b.VARIABLE_LENGTH_SIZE mVARIABLE_LENGTH_SIZE,	b.VARIABLE_LENGTH_SEGMENTS mVARIABLE_LENGTH_SEGMENTS,	b.FIXED_LENGTH_EXTENTS mFIXED_LENGTH_EXTENTS,
	b.VARIABLE_LENGTH_EXTENTS mVARIABLE_LENGTH_EXTENTS,	b.COLUMN_STATS_SIZE mCOLUMN_STATS_SIZE,	b.MAINTAINED_TEMPORARY_INDEX_SIZE mMAINTAINED_TEMPORARY_INDEX_SIZE,
	b.NUMBER_DISTINCT_INDEXES mNUMBER_DISTINCT_INDEXES,	b.OPEN_OPERATIONS mOPEN_OPERATIONS,	b.CLOSE_OPERATIONS mCLOSE_OPERATIONS,	b.INSERT_OPERATIONS mINSERT_OPERATIONS,
	b.BLOCKED_INSERT_OPERATIONS mBLOCKED_INSERT_OPERATIONS,	b.BLOCKED_INSERT_ROWS mBLOCKED_INSERT_ROWS,	b.UPDATE_OPERATIONS mUPDATE_OPERATIONS,	b.DELETE_OPERATIONS mDELETE_OPERATIONS,
	b.CLEAR_OPERATIONS mCLEAR_OPERATIONS,	b.COPY_OPERATIONS mCOPY_OPERATIONS,	b.REORGANIZE_OPERATIONS mREORGANIZE_OPERATIONS,	b.INDEX_BUILDS mINDEX_BUILDS,	b.LOGICAL_READS mLOGICAL_READS,
	b.PHYSICAL_READS mPHYSICAL_READS,	b.SEQUENTIAL_READS mSEQUENTIAL_READS,	b.RANDOM_READS mRANDOM_READS,	b.CREATE_TIMESTAMP mCREATE_TIMESTAMP,	b.LAST_CHANGE_TIMESTAMP mLAST_CHANGE_TIMESTAMP,
	b.LAST_SAVE_TIMESTAMP mLAST_SAVE_TIMESTAMP,	b.LAST_RESTORE_TIMESTAMP mLAST_RESTORE_TIMESTAMP,	b.LAST_USED_TIMESTAMP mLAST_USED_TIMESTAMP,	b.DAYS_USED_COUNT mDAYS_USED_COUNT,
	b.LAST_RESET_TIMESTAMP mLAST_RESET_TIMESTAMP,	b.NEXT_IDENTITY_VALUE mNEXT_IDENTITY_VALUE,	b.LOWINCLUSIVE mLOWINCLUSIVE,	b.LOWVALUE mLOWVALUE,	b.HIGHINCLUSIVE mHIGHINCLUSIVE,
	b.HIGHVALUE mHIGHVALUE,	b.NUMBER_PARTITIONING_KEYS mNUMBER_PARTITIONING_KEYS,	b.PARTITIONING_KEYS mPARTITIONING_KEYS,	b.KEEP_IN_MEMORY mKEEP_IN_MEMORY,
	b.MEDIA_PREFERENCE mMEDIA_PREFERENCE,	b.LAST_SOURCE_UPDATE_TIMESTAMP mLAST_SOURCE_UPDATE_TIMESTAMP,	b.SOURCE_TYPE mSOURCE_TYPE,	b.VOLATILE mVOLATILE,	b.PARTITION_TEXT mPARTITION_TEXT,
	b.PARTIAL_TRANSACTION mPARTIAL_TRANSACTION,	b.APPLY_STARTING_RECEIVER_LIBRARY mAPPLY_STARTING_RECEIVER_LIBRARY,	b.APPLY_STARTING_RECEIVER mAPPLY_STARTING_RECEIVER,	b.SYSTEM_TABLE_SCHEMA mSYSTEM_TABLE_SCHEMA,
	b.SYSTEM_TABLE_NAME mSYSTEM_TABLE_NAME,	b.SYSTEM_TABLE_MEMBER mSYSTEM_TABLE_MEMBER
FROM ITMN_DASHBOARD.ITMNL.ITMNF03_NDC a INNER JOIN ITMN_DASHBOARD.ITMNL.ITMNF04_NDC b ON 
a.whse=b.whse AND a.envn=b.envn AND a.SYSTEM_TABLE_SCHEMA = b.SYSTEM_TABLE_SCHEMA AND a.system_table_name = b.SYSTEM_TABLE_NAME  
UNION ALL
SELECT a.*,
    b.WHSE mWHSE,	b.ENVN mENVN,	b.REPORT mREPORT,	b.TIME_STAMP mTIME_STAMP,	b.TABLE_SCHEMA mTABLE_SCHEMA,	b.TABLE_NAME mTABLE_NAME,
	b.TABLE_PARTITION mTABLE_PARTITION,	b.PARTITION_TYPE mPARTITION_TYPE,	b.PARTITION_NUMBER mPARTITION_NUMBER,	b.NUMBER_DISTRIBUTED_PARTITIONS mNUMBER_DISTRIBUTED_PARTITIONS,
	b.NUMBER_ROWS mNUMBER_ROWS,	b.NUMBER_ROW_PAGES mNUMBER_ROW_PAGES,	b.NUMBER_PAGES mNUMBER_PAGES,	b.OVERFLOW mOVERFLOW,	b.CLUSTERED mCLUSTERED,
	b.ACTIVE_BLOCKS mACTIVE_BLOCKS,	b.AVGCOMPRESSEDROWSIZE mAVGCOMPRESSEDROWSIZE,	b.AVGROWCOMPRESSIONRATIO mAVGROWCOMPRESSIONRATIO,	b.AVGROWSIZE mAVGROWSIZE,
	b.PCTROWSCOMPRESSED mPCTROWSCOMPRESSED,	b.PCTPAGESSAVED mPCTPAGESSAVED,	b.NUMBER_DELETED_ROWS mNUMBER_DELETED_ROWS,	b.DATA_SIZE mDATA_SIZE,
	b.VARIABLE_LENGTH_SIZE mVARIABLE_LENGTH_SIZE,	b.VARIABLE_LENGTH_SEGMENTS mVARIABLE_LENGTH_SEGMENTS,	b.FIXED_LENGTH_EXTENTS mFIXED_LENGTH_EXTENTS,
	b.VARIABLE_LENGTH_EXTENTS mVARIABLE_LENGTH_EXTENTS,	b.COLUMN_STATS_SIZE mCOLUMN_STATS_SIZE,	b.MAINTAINED_TEMPORARY_INDEX_SIZE mMAINTAINED_TEMPORARY_INDEX_SIZE,
	b.NUMBER_DISTINCT_INDEXES mNUMBER_DISTINCT_INDEXES,	b.OPEN_OPERATIONS mOPEN_OPERATIONS,	b.CLOSE_OPERATIONS mCLOSE_OPERATIONS,	b.INSERT_OPERATIONS mINSERT_OPERATIONS,
	b.BLOCKED_INSERT_OPERATIONS mBLOCKED_INSERT_OPERATIONS,	b.BLOCKED_INSERT_ROWS mBLOCKED_INSERT_ROWS,	b.UPDATE_OPERATIONS mUPDATE_OPERATIONS,	b.DELETE_OPERATIONS mDELETE_OPERATIONS,
	b.CLEAR_OPERATIONS mCLEAR_OPERATIONS,	b.COPY_OPERATIONS mCOPY_OPERATIONS,	b.REORGANIZE_OPERATIONS mREORGANIZE_OPERATIONS,	b.INDEX_BUILDS mINDEX_BUILDS,	b.LOGICAL_READS mLOGICAL_READS,
	b.PHYSICAL_READS mPHYSICAL_READS,	b.SEQUENTIAL_READS mSEQUENTIAL_READS,	b.RANDOM_READS mRANDOM_READS,	b.CREATE_TIMESTAMP mCREATE_TIMESTAMP,	b.LAST_CHANGE_TIMESTAMP mLAST_CHANGE_TIMESTAMP,
	b.LAST_SAVE_TIMESTAMP mLAST_SAVE_TIMESTAMP,	b.LAST_RESTORE_TIMESTAMP mLAST_RESTORE_TIMESTAMP,	b.LAST_USED_TIMESTAMP mLAST_USED_TIMESTAMP,	b.DAYS_USED_COUNT mDAYS_USED_COUNT,
	b.LAST_RESET_TIMESTAMP mLAST_RESET_TIMESTAMP,	b.NEXT_IDENTITY_VALUE mNEXT_IDENTITY_VALUE,	b.LOWINCLUSIVE mLOWINCLUSIVE,	b.LOWVALUE mLOWVALUE,	b.HIGHINCLUSIVE mHIGHINCLUSIVE,
	b.HIGHVALUE mHIGHVALUE,	b.NUMBER_PARTITIONING_KEYS mNUMBER_PARTITIONING_KEYS,	b.PARTITIONING_KEYS mPARTITIONING_KEYS,	b.KEEP_IN_MEMORY mKEEP_IN_MEMORY,
	b.MEDIA_PREFERENCE mMEDIA_PREFERENCE,	b.LAST_SOURCE_UPDATE_TIMESTAMP mLAST_SOURCE_UPDATE_TIMESTAMP,	b.SOURCE_TYPE mSOURCE_TYPE,	b.VOLATILE mVOLATILE,	b.PARTITION_TEXT mPARTITION_TEXT,
	b.PARTIAL_TRANSACTION mPARTIAL_TRANSACTION,	b.APPLY_STARTING_RECEIVER_LIBRARY mAPPLY_STARTING_RECEIVER_LIBRARY,	b.APPLY_STARTING_RECEIVER mAPPLY_STARTING_RECEIVER,	b.SYSTEM_TABLE_SCHEMA mSYSTEM_TABLE_SCHEMA,
	b.SYSTEM_TABLE_NAME mSYSTEM_TABLE_NAME,	b.SYSTEM_TABLE_MEMBER mSYSTEM_TABLE_MEMBER
FROM ITMN_DASHBOARD.ITMNL.ITMNF03_SC1 a INNER JOIN ITMN_DASHBOARD.ITMNL.ITMNF04_SC1 b ON 
a.whse=b.whse AND a.envn=b.envn AND a.SYSTEM_TABLE_SCHEMA = b.SYSTEM_TABLE_SCHEMA AND a.system_table_name = b.SYSTEM_TABLE_NAME  
UNION ALL
SELECT a.*,
    b.WHSE mWHSE,	b.ENVN mENVN,	b.REPORT mREPORT,	b.TIME_STAMP mTIME_STAMP,	b.TABLE_SCHEMA mTABLE_SCHEMA,	b.TABLE_NAME mTABLE_NAME,
	b.TABLE_PARTITION mTABLE_PARTITION,	b.PARTITION_TYPE mPARTITION_TYPE,	b.PARTITION_NUMBER mPARTITION_NUMBER,	b.NUMBER_DISTRIBUTED_PARTITIONS mNUMBER_DISTRIBUTED_PARTITIONS,
	b.NUMBER_ROWS mNUMBER_ROWS,	b.NUMBER_ROW_PAGES mNUMBER_ROW_PAGES,	b.NUMBER_PAGES mNUMBER_PAGES,	b.OVERFLOW mOVERFLOW,	b.CLUSTERED mCLUSTERED,
	b.ACTIVE_BLOCKS mACTIVE_BLOCKS,	b.AVGCOMPRESSEDROWSIZE mAVGCOMPRESSEDROWSIZE,	b.AVGROWCOMPRESSIONRATIO mAVGROWCOMPRESSIONRATIO,	b.AVGROWSIZE mAVGROWSIZE,
	b.PCTROWSCOMPRESSED mPCTROWSCOMPRESSED,	b.PCTPAGESSAVED mPCTPAGESSAVED,	b.NUMBER_DELETED_ROWS mNUMBER_DELETED_ROWS,	b.DATA_SIZE mDATA_SIZE,
	b.VARIABLE_LENGTH_SIZE mVARIABLE_LENGTH_SIZE,	b.VARIABLE_LENGTH_SEGMENTS mVARIABLE_LENGTH_SEGMENTS,	b.FIXED_LENGTH_EXTENTS mFIXED_LENGTH_EXTENTS,
	b.VARIABLE_LENGTH_EXTENTS mVARIABLE_LENGTH_EXTENTS,	b.COLUMN_STATS_SIZE mCOLUMN_STATS_SIZE,	b.MAINTAINED_TEMPORARY_INDEX_SIZE mMAINTAINED_TEMPORARY_INDEX_SIZE,
	b.NUMBER_DISTINCT_INDEXES mNUMBER_DISTINCT_INDEXES,	b.OPEN_OPERATIONS mOPEN_OPERATIONS,	b.CLOSE_OPERATIONS mCLOSE_OPERATIONS,	b.INSERT_OPERATIONS mINSERT_OPERATIONS,
	b.BLOCKED_INSERT_OPERATIONS mBLOCKED_INSERT_OPERATIONS,	b.BLOCKED_INSERT_ROWS mBLOCKED_INSERT_ROWS,	b.UPDATE_OPERATIONS mUPDATE_OPERATIONS,	b.DELETE_OPERATIONS mDELETE_OPERATIONS,
	b.CLEAR_OPERATIONS mCLEAR_OPERATIONS,	b.COPY_OPERATIONS mCOPY_OPERATIONS,	b.REORGANIZE_OPERATIONS mREORGANIZE_OPERATIONS,	b.INDEX_BUILDS mINDEX_BUILDS,	b.LOGICAL_READS mLOGICAL_READS,
	b.PHYSICAL_READS mPHYSICAL_READS,	b.SEQUENTIAL_READS mSEQUENTIAL_READS,	b.RANDOM_READS mRANDOM_READS,	b.CREATE_TIMESTAMP mCREATE_TIMESTAMP,	b.LAST_CHANGE_TIMESTAMP mLAST_CHANGE_TIMESTAMP,
	b.LAST_SAVE_TIMESTAMP mLAST_SAVE_TIMESTAMP,	b.LAST_RESTORE_TIMESTAMP mLAST_RESTORE_TIMESTAMP,	b.LAST_USED_TIMESTAMP mLAST_USED_TIMESTAMP,	b.DAYS_USED_COUNT mDAYS_USED_COUNT,
	b.LAST_RESET_TIMESTAMP mLAST_RESET_TIMESTAMP,	b.NEXT_IDENTITY_VALUE mNEXT_IDENTITY_VALUE,	b.LOWINCLUSIVE mLOWINCLUSIVE,	b.LOWVALUE mLOWVALUE,	b.HIGHINCLUSIVE mHIGHINCLUSIVE,
	b.HIGHVALUE mHIGHVALUE,	b.NUMBER_PARTITIONING_KEYS mNUMBER_PARTITIONING_KEYS,	b.PARTITIONING_KEYS mPARTITIONING_KEYS,	b.KEEP_IN_MEMORY mKEEP_IN_MEMORY,
	b.MEDIA_PREFERENCE mMEDIA_PREFERENCE,	b.LAST_SOURCE_UPDATE_TIMESTAMP mLAST_SOURCE_UPDATE_TIMESTAMP,	b.SOURCE_TYPE mSOURCE_TYPE,	b.VOLATILE mVOLATILE,	b.PARTITION_TEXT mPARTITION_TEXT,
	b.PARTIAL_TRANSACTION mPARTIAL_TRANSACTION,	b.APPLY_STARTING_RECEIVER_LIBRARY mAPPLY_STARTING_RECEIVER_LIBRARY,	b.APPLY_STARTING_RECEIVER mAPPLY_STARTING_RECEIVER,	b.SYSTEM_TABLE_SCHEMA mSYSTEM_TABLE_SCHEMA,
	b.SYSTEM_TABLE_NAME mSYSTEM_TABLE_NAME,	b.SYSTEM_TABLE_MEMBER mSYSTEM_TABLE_MEMBER
FROM ITMN_DASHBOARD.ITMNL.ITMNF03_DEV a INNER JOIN ITMN_DASHBOARD.ITMNL.ITMNF04_DEV b ON 
a.whse=b.whse AND a.envn=b.envn AND a.SYSTEM_TABLE_SCHEMA = b.SYSTEM_TABLE_SCHEMA AND a.system_table_name = b.SYSTEM_TABLE_NAME  
);


SELECT TABLE_CATALOG ,TABLE_SCHEMA ,TABLE_NAME, last_altered FROM itmn_dashboard.INFORMATION_SCHEMA.TABLES
WHERE TABLE_NAME LIKE 'ITMNF01_%';

SELECT * FROM itmn_dashboard.INFORMATION_SCHEMA.TABLES
WHERE TABLE_NAME LIKE 'ITMNF01_%';

----summary by library
SELECT whse, envn, system_table_schema, count(*)FROM  ITMN_DASHBOARD.ITMNL.ITMNF03a
WHERE envn='PD' AND system_table_schema LIKE '%GLD%'  ---whse='SC1'
GROUP BY whse, envn, system_table_schema
ORDER BY 1,2,3;
----summary by library
SELECT whse, envn, system_table_schema, a.* FROM  ITMN_DASHBOARD.ITMNL.ITMNF03 a
WHERE envn='PD' AND system_table_schema = 'ATTRIB'  ---whse='SC1'
ORDER BY 1,2,3;
---- markmagic ?
SELECT whse, envn, table_schema, table_name, a.* FROM  ITMN_DASHBOARD.ITMNL.ITMNF03 a 
WHERE TABLE_NAME='FMTSPF90' AND envn='PD' --AND whse='NDC'
ORDER BY 1,2,3,4;
---- markmagic ?
SELECT whse, envn, table_schema, table_name, a.NUMBER_ROWS ,a.LAST_USED_TIMESTAMP , a.DAYS_USED_COUNT ,a.* FROM  ITMN_DASHBOARD.ITMNL.ITMNF04 a 
WHERE TABLE_NAME='FMTSPF90' AND envn='PD' ---AND whse='NDC'
ORDER BY 1,2,3,4;

--Duplicates
SELECT whse, envn, table_name, count(*) FROM  ITMN_DASHBOARD.ITMNL.ITMNF03 a 
WHERE envn='PD' AND whse='NDC' ---AND table_schema IN ('TEGILBASP','WMGILBASP')
GROUP BY whse, envn, table_name
HAVING count(*)> 1
ORDER BY 1,2,3;


--- journal lib/name
SELECT whse, envn,journal_library, journal_name, a.* FROM  ITMN_DASHBOARD.ITMNL.ITMNF02 a;
SELECT whse, envn,journal_library, journal_name, a.* FROM  ITMN_DASHBOARD.ITMNL.ITMNF02 a WHERE journal_library is NULL AND objtype='*FILE';

SELECT whse, envn,journal_library, journal_name,objtype, count(*) FROM  ITMN_DASHBOARD.ITMNL.ITMNF02
WHERE envn='PD' AND objtype='*FILE'
GROUP BY whse, envn,journal_library, journal_name,objtype
ORDER BY 1,2,3,4;


----remove libraries
SELECT * FROM  ITMN_DASHBOARD.ITMNL.ITMNF03  ;
SELECT * FROM  ITMN_DASHBOARD.ITMNL.ITMNF04  WHERE TABLE_NAME= 'FSFTPO00' AND whse='JAX'; --XBCTRL00'; --'PATRAC00';  --';
SELECT * FROM  ITMN_DASHBOARD.ITMNL.ITMNF03a  ;
SELECT * FROM  ITMN_DASHBOARD.ITMNL.ITMNF02  ;
SELECT objtype, count(*) FROM  ITMN_DASHBOARD.ITMNL.ITMNF02 GROUP BY objtype ORDER BY 1 ;
SELECT objlib, a.* FROM  ITMN_DASHBOARD.ITMNL.ITMNF02 a WHERE  objlib='WMTEST' ORDER BY 1 ;
SELECT a.* FROM  ITMN_DASHBOARD.ITMNL.ITMNF03A a  ;

--- files to be reorganized
SELECT whse, envn, report, table_schema, table_name, number_rows,number_deleted_rows, data_size/1000000000 Gig, CAST(number_rows/26 AS integer) AS PerWeek,delete_operations
FROM  ITMN_DASHBOARD.ITMNL.ITMNF04  WHERE TABLE_NAME= 'PXSTYL00' AND envn='PD';

SELECT whse, envn, table_schema, table_name, table_partition, number_rows,number_deleted_rows, data_size/1000000000 Gig, CAST(number_rows/26 AS integer) AS PerWeek,delete_operations
FROM  ITMN_DASHBOARD.ITMNL.ITMNF04  WHERE  envn='DV' AND whse='NDC' and number_deleted_rows>0 AND number_rows/26 < NUMBER_DELETED_ROWS ---TABLE_NAME= 'PXSTYL00' AND
ORDER BY 1,data_size desc;

---remove libraries
SELECT * FROM  ITMN_DASHBOARD.ITMNL.ITMNF05  WHERE whse='SC1' AND envn='PD' ;
SELECT * FROM  ITMN_DASHBOARD.ITMNL.ITMNF05  WHERE envn='JAX'  AND LN LIKE '%400%';

SELECT * FROM  ITMN_DASHBOARD.ITMNL.ITMNF01  ;
-------------------------------------
SELECT * FROM  ITMN_DASHBOARD.ITMNL.ITMNF05 WHERE (LN LIKE 'WM%' OR LN LIKE 'TE%' ) AND envn='PD' ORDER by 1,5 ;

---Discrepancy- 


---F4111
USE DATABASE e1_PRODUCTION;
SELECT * FROM E1.f4111 LIMIT 10;

SELECT illitm, ildoco,ildcto, ildoc,ildct, iltrqt, iltrum, a.* 
FROM E1.f4111 a 
WHERE ilmcu='NDC' AND illitm = '17C11DALG0' AND ilcrdj BETWEEN '2025-02-07' AND '2025-03-07' LIMIT 10;
--summary
SELECT illitm, ildoco,ildcto,  iltrum, sum(iltrqt) , sum(iltrqt)*12
FROM E1.f4111 a 
WHERE ilmcu='NDC' AND illitm = '17C11DALG0' AND ilcrdj BETWEEN '2025-02-07' AND '2025-03-07' 
GROUP BY illitm, ildoco,ildcto,  iltrum ORDER BY 1,2,3,4;

SELECT limcu,count(*) FROM e1.f41021 a  


